
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>heimdallr.utilities.nvidia.smi_parsing &#8212; heimdallr 0.2.7 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <link rel="canonical" href="aivclab.github.io/heimdallr/_modules/heimdallr/utilities/nvidia/smi_parsing.html" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for heimdallr.utilities.nvidia.smi_parsing</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Christian&quot;</span>
<span class="vm">__doc__</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">           Created on 29/03/2020</span>
<span class="s2">           &quot;&quot;&quot;</span>

<span class="c1"># ============================================================================ #</span>
<span class="c1"># Copyright (c) 2011-2019, NVIDIA Corporation.  All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1">#    * Redistributions of source code must retain the above copyright notice,</span>
<span class="c1">#      this list of conditions and the following disclaimer.</span>
<span class="c1">#    * Redistributions in binary form must reproduce the above copyright</span>
<span class="c1">#      notice, this list of conditions and the following disclaimer in the</span>
<span class="c1">#      documentation and/or other materials provided with the distribution.</span>
<span class="c1">#    * Neither the name of the NVIDIA Corporation nor the names of its</span>
<span class="c1">#      contributors may be used to endorse or promote products derived from</span>
<span class="c1">#      this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
<span class="c1"># ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE</span>
<span class="c1"># LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span>
<span class="c1"># CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span>
<span class="c1"># SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span>
<span class="c1"># INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span>
<span class="c1"># CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span>
<span class="c1"># ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF</span>
<span class="c1"># THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="c1"># ============================================================================ #</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">nvidia_smi</span>

<span class="sd">Sample code that attempts to reproduce the output of nvidia-smi -q -x</span>
<span class="sd">For many cases the output should match.</span>
<span class="sd">Each query parameter is documented within nvdia-smi --help-query-gpu</span>

<span class="sd">From Code:</span>
<span class="sd">DeviceQuery()</span>
<span class="sd">DeviceQuery(&quot;--help&quot;)</span>
<span class="sd">DeviceQuery(&quot;--help_query_gpu&quot;)</span>
<span class="sd">DeviceQuery(&quot;pci.bus_id,memory.total,memory.free&quot;)</span>
<span class="sd">DeviceQuery([NVSMI_PCI_BUS_ID, NVSMI_MEMORY_TOTAL, NVSMI_MEMORY_FREE])</span>

<span class="sd">XmlDeviceQuery()</span>
<span class="sd">XmlDeviceQuery(&quot;--help&quot;)</span>
<span class="sd">XmlDeviceQuery(&quot;--help_query_gpu&quot;)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span>

<span class="kn">from</span> <span class="nn">.bindings</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1">## ========================================================================== ##</span>
<span class="c1">##                                                                            ##</span>
<span class="c1">##                              Enumerations                                  ##</span>
<span class="c1">##                                                                            ##</span>
<span class="c1">## ========================================================================== ##</span>

<span class="c1"># Details and descriptions for enumerations in help_query_gpu.txt</span>
<span class="n">NVSMI_ALL</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

<span class="n">NVSMI_TIMESTAMP</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">NVSMI_DRIVER_VERSION</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">NVSMI_COUNT</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">NVSMI_NAME</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">NVSMI_SERIALNUMBER</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">NVSMI_UUID</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">NVSMI_PCI_BUS_ID</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">NVSMI_PCI_DOMAIN</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">NVSMI_PCI_BUS</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">NVSMI_PCI_DEVICE</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">NVSMI_PCI_DEVICE_ID</span> <span class="o">=</span> <span class="mi">11</span>
<span class="n">NVSMI_PCI_SUBDEVICE_ID</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">NVSMI_PCI_LINK_GEN_CUR</span> <span class="o">=</span> <span class="mi">13</span>
<span class="n">NVSMI_PCI_LINK_GEN_MAX</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">NVSMI_PCI_LINK_WIDTH_CUR</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">NVSMI_PCI_LINK_WIDTH_MAX</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">NVSMI_INDEX</span> <span class="o">=</span> <span class="mi">17</span>
<span class="n">NVSMI_DISPLAY_MODE</span> <span class="o">=</span> <span class="mi">18</span>
<span class="n">NVSMI_DISPLAY_ACTIVE</span> <span class="o">=</span> <span class="mi">19</span>
<span class="n">NVSMI_PERSISTENCE_MODE</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">NVSMI_ACCT_MODE</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">NVSMI_ACCT_BUFFER_SIZE</span> <span class="o">=</span> <span class="mi">22</span>
<span class="n">NVSMI_DRIVER_MODEL_CUR</span> <span class="o">=</span> <span class="mi">23</span>
<span class="n">NVSMI_DRIVER_MODEL_PENDING</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">NVSMI_VBIOS_VER</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">NVSMI_BOARD_ID</span> <span class="o">=</span> <span class="mi">26</span>

<span class="n">NVSMI_INFOROM_IMG</span> <span class="o">=</span> <span class="mi">190</span>
<span class="n">NVSMI_INFOROM_OEM</span> <span class="o">=</span> <span class="mi">191</span>
<span class="n">NVSMI_INFOROM_ECC</span> <span class="o">=</span> <span class="mi">192</span>
<span class="n">NVSMI_INFOROM_PWR</span> <span class="o">=</span> <span class="mi">193</span>

<span class="n">NVSMI_GOM_CUR</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">NVSMI_GOM_PENDING</span> <span class="o">=</span> <span class="mi">31</span>

<span class="n">NVSMI_FAN_SPEED</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">NVSMI_PSTATE</span> <span class="o">=</span> <span class="mi">33</span>

<span class="n">NVSMI_MEMORY_TOTAL</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">NVSMI_MEMORY_FREE</span> <span class="o">=</span> <span class="mi">51</span>
<span class="n">NVSMI_MEMORY_USED</span> <span class="o">=</span> <span class="mi">52</span>
<span class="n">NVSMI_COMPUTE_MODE</span> <span class="o">=</span> <span class="mi">53</span>
<span class="n">NVSMI_MEMORY_BAR1</span> <span class="o">=</span> <span class="mi">54</span>

<span class="n">NVSMI_UTILIZATION_GPU</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">NVSMI_UTILIZATION_MEM</span> <span class="o">=</span> <span class="mi">61</span>
<span class="n">NVSMI_UTILIZATION_ENCODER</span> <span class="o">=</span> <span class="mi">62</span>
<span class="n">NVSMI_UTILIZATION_DECODER</span> <span class="o">=</span> <span class="mi">63</span>

<span class="n">NVSMI_ENCODER_STATS_SESSIONCOUNT</span> <span class="o">=</span> <span class="mi">260</span>
<span class="n">NVSMI_ENCODER_STATS_AVG_EPS</span> <span class="o">=</span> <span class="mi">261</span>
<span class="n">NVSMI_ENCODER_STATS_AVG_LATENCY</span> <span class="o">=</span> <span class="mi">262</span>

<span class="n">NVSMI_ECC_MODE_CUR</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">NVSMI_ECC_MODE_PENDING</span> <span class="o">=</span> <span class="mi">71</span>

<span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_DEV_MEM</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_REGFILE</span> <span class="o">=</span> <span class="mi">81</span>
<span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L1CACHE</span> <span class="o">=</span> <span class="mi">82</span>
<span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L2CACHE</span> <span class="o">=</span> <span class="mi">83</span>
<span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_TEXTURE</span> <span class="o">=</span> <span class="mi">84</span>
<span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_TOTAL</span> <span class="o">=</span> <span class="mi">85</span>

<span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_DEV_MEM</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_REGFILE</span> <span class="o">=</span> <span class="mi">91</span>
<span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L1CACHE</span> <span class="o">=</span> <span class="mi">92</span>
<span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L2CACHE</span> <span class="o">=</span> <span class="mi">93</span>
<span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TEXTURE</span> <span class="o">=</span> <span class="mi">94</span>
<span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TOTAL</span> <span class="o">=</span> <span class="mi">95</span>

<span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_DEV_MEM</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_REGFILE</span> <span class="o">=</span> <span class="mi">101</span>
<span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_L1CACHE</span> <span class="o">=</span> <span class="mi">102</span>
<span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_L2CACHE</span> <span class="o">=</span> <span class="mi">103</span>
<span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_TEXTURE</span> <span class="o">=</span> <span class="mi">104</span>
<span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_TOTAL</span> <span class="o">=</span> <span class="mi">105</span>

<span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_DEV_MEM</span> <span class="o">=</span> <span class="mi">110</span>
<span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_REGFILE</span> <span class="o">=</span> <span class="mi">111</span>
<span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_L1CACHE</span> <span class="o">=</span> <span class="mi">112</span>
<span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_L2CACHE</span> <span class="o">=</span> <span class="mi">113</span>
<span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_TEXTURE</span> <span class="o">=</span> <span class="mi">114</span>
<span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_TOTAL</span> <span class="o">=</span> <span class="mi">115</span>

<span class="n">NVSMI_RETIREDPAGES_SINGLE_BIT_ECC_COUNT</span> <span class="o">=</span> <span class="mi">120</span>
<span class="n">NVSMI_RETIREDPAGES_DOUBLE_BIT_ECC_COUNT</span> <span class="o">=</span> <span class="mi">121</span>
<span class="n">NVSMI_RETIREDPAGES_PENDING</span> <span class="o">=</span> <span class="mi">122</span>

<span class="n">NVSMI_CLOCK_THROTTLE_REASONS_SUPPORTED</span> <span class="o">=</span> <span class="mi">170</span>
<span class="n">NVSMI_CLOCK_THROTTLE_REASONS_ACTIVE</span> <span class="o">=</span> <span class="mi">171</span>
<span class="n">NVSMI_CLOCK_THROTTLE_REASONS_IDLE</span> <span class="o">=</span> <span class="mi">172</span>
<span class="n">NVSMI_CLOCK_THROTTLE_REASONS_APP_SETTING</span> <span class="o">=</span> <span class="mi">173</span>
<span class="n">NVSMI_CLOCK_THROTTLE_REASONS_SW_PWR_CAP</span> <span class="o">=</span> <span class="mi">174</span>
<span class="n">NVSMI_CLOCK_THROTTLE_REASONS_HW_SLOWDOWN</span> <span class="o">=</span> <span class="mi">175</span>

<span class="n">NVSMI_CLOCK_THROTTLE_REASONS_HW_THERMAL_SLOWDOWN</span> <span class="o">=</span> <span class="mi">176</span>
<span class="n">NVSMI_CLOCK_THROTTLE_REASONS_HW_PWR_BRAKE_SLOWDOWN</span> <span class="o">=</span> <span class="mi">177</span>
<span class="n">NVSMI_CLOCK_THROTTLE_REASONS_SW_THERMAL_SLOWDOWN</span> <span class="o">=</span> <span class="mi">178</span>
<span class="n">NVSMI_CLOCK_THROTTLE_REASONS_SYNC_BOOST</span> <span class="o">=</span> <span class="mi">179</span>

<span class="n">NVSMI_TEMPERATURE_GPU</span> <span class="o">=</span> <span class="mi">130</span>
<span class="n">NVSMI_TEMPERATURE_MEMORY</span> <span class="o">=</span> <span class="mi">131</span>

<span class="n">NVSMI_POWER_MGMT</span> <span class="o">=</span> <span class="mi">140</span>
<span class="n">NVSMI_POWER_DRAW</span> <span class="o">=</span> <span class="mi">141</span>
<span class="n">NVSMI_POWER_LIMIT</span> <span class="o">=</span> <span class="mi">142</span>
<span class="n">NVSMI_POWER_LIMIT_ENFORCED</span> <span class="o">=</span> <span class="mi">143</span>
<span class="n">NVSMI_POWER_LIMIT_DEFAULT</span> <span class="o">=</span> <span class="mi">144</span>
<span class="n">NVSMI_POWER_LIMIT_MIN</span> <span class="o">=</span> <span class="mi">145</span>
<span class="n">NVSMI_POWER_LIMIT_MAX</span> <span class="o">=</span> <span class="mi">146</span>

<span class="n">NVSMI_CLOCKS_GRAPHICS_CUR</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">NVSMI_CLOCKS_SM_CUR</span> <span class="o">=</span> <span class="mi">151</span>
<span class="n">NVSMI_CLOCKS_MEMORY_CUR</span> <span class="o">=</span> <span class="mi">152</span>
<span class="n">NVSMI_CLOCKS_VIDEO_CUR</span> <span class="o">=</span> <span class="mi">153</span>
<span class="n">NVSMI_CLOCKS_APPL_GRAPHICS</span> <span class="o">=</span> <span class="mi">154</span>
<span class="n">NVSMI_CLOCKS_APPL_MEMORY</span> <span class="o">=</span> <span class="mi">155</span>
<span class="n">NVSMI_CLOCKS_APPL_GRAPHICS_DEFAULT</span> <span class="o">=</span> <span class="mi">156</span>
<span class="n">NVSMI_CLOCKS_APPL_MEMORY_DEFAULT</span> <span class="o">=</span> <span class="mi">157</span>
<span class="n">NVSMI_CLOCKS_GRAPHICS_MAX</span> <span class="o">=</span> <span class="mi">158</span>
<span class="n">NVSMI_CLOCKS_SM_MAX</span> <span class="o">=</span> <span class="mi">159</span>
<span class="n">NVSMI_CLOCKS_MEMORY_MAX</span> <span class="o">=</span> <span class="mi">160</span>

<span class="n">NVSMI_COMPUTE_APPS</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">NVSMI_ACCOUNTED_APPS</span> <span class="o">=</span> <span class="mi">201</span>
<span class="n">NVSMI_CLOCKS_POLICY</span> <span class="o">=</span> <span class="mi">202</span>
<span class="n">NVSMI_CLOCKS_SUPPORTED</span> <span class="o">=</span> <span class="mi">203</span>

<span class="c1"># Details and descriptions for enumerations in help_query_gpu.txt</span>
<span class="n">NVSMI_QUERY_GPU</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span>                                           <span class="n">NVSMI_TIMESTAMP</span><span class="p">,</span>
    <span class="s2">&quot;driver_version&quot;</span><span class="p">:</span>                                      <span class="n">NVSMI_DRIVER_VERSION</span><span class="p">,</span>
    <span class="s2">&quot;count&quot;</span><span class="p">:</span>                                               <span class="n">NVSMI_COUNT</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span>                                                <span class="n">NVSMI_NAME</span><span class="p">,</span>
    <span class="s2">&quot;gpu_name&quot;</span><span class="p">:</span>                                            <span class="n">NVSMI_NAME</span><span class="p">,</span>
    <span class="s2">&quot;serial&quot;</span><span class="p">:</span>                                              <span class="n">NVSMI_SERIALNUMBER</span><span class="p">,</span>
    <span class="s2">&quot;gpu_serial&quot;</span><span class="p">:</span>                                          <span class="n">NVSMI_SERIALNUMBER</span><span class="p">,</span>
    <span class="s2">&quot;uuid&quot;</span><span class="p">:</span>                                                <span class="n">NVSMI_UUID</span><span class="p">,</span>
    <span class="s2">&quot;gpu_uuid&quot;</span><span class="p">:</span>                                            <span class="n">NVSMI_UUID</span><span class="p">,</span>
    <span class="s2">&quot;pci.bus_id&quot;</span><span class="p">:</span>                                          <span class="n">NVSMI_PCI_BUS_ID</span><span class="p">,</span>
    <span class="s2">&quot;gpu_bus_id&quot;</span><span class="p">:</span>                                          <span class="n">NVSMI_PCI_BUS_ID</span><span class="p">,</span>
    <span class="s2">&quot;pci.domain&quot;</span><span class="p">:</span>                                          <span class="n">NVSMI_PCI_DOMAIN</span><span class="p">,</span>
    <span class="s2">&quot;pci.bus&quot;</span><span class="p">:</span>                                             <span class="n">NVSMI_PCI_BUS</span><span class="p">,</span>
    <span class="s2">&quot;pci.device&quot;</span><span class="p">:</span>                                          <span class="n">NVSMI_PCI_DEVICE</span><span class="p">,</span>
    <span class="s2">&quot;pci.device_id&quot;</span><span class="p">:</span>                                       <span class="n">NVSMI_PCI_DEVICE_ID</span><span class="p">,</span>
    <span class="s2">&quot;pci.sub_device_id&quot;</span><span class="p">:</span>                                   <span class="n">NVSMI_PCI_SUBDEVICE_ID</span><span class="p">,</span>
    <span class="s2">&quot;pcie.link.gen.current&quot;</span><span class="p">:</span>                               <span class="n">NVSMI_PCI_LINK_GEN_CUR</span><span class="p">,</span>
    <span class="s2">&quot;pcie.link.gen.max&quot;</span><span class="p">:</span>                                   <span class="n">NVSMI_PCI_LINK_GEN_MAX</span><span class="p">,</span>
    <span class="s2">&quot;pcie.link.width.current&quot;</span><span class="p">:</span>                             <span class="n">NVSMI_PCI_LINK_WIDTH_CUR</span><span class="p">,</span>
    <span class="s2">&quot;pcie.link.width.max&quot;</span><span class="p">:</span>                                 <span class="n">NVSMI_PCI_LINK_WIDTH_MAX</span><span class="p">,</span>
    <span class="s2">&quot;index&quot;</span><span class="p">:</span>                                               <span class="n">NVSMI_INDEX</span><span class="p">,</span>
    <span class="s2">&quot;display_mode&quot;</span><span class="p">:</span>                                        <span class="n">NVSMI_DISPLAY_MODE</span><span class="p">,</span>
    <span class="s2">&quot;display_active&quot;</span><span class="p">:</span>                                      <span class="n">NVSMI_DISPLAY_ACTIVE</span><span class="p">,</span>
    <span class="s2">&quot;persistence_mode&quot;</span><span class="p">:</span>                                    <span class="n">NVSMI_PERSISTENCE_MODE</span><span class="p">,</span>
    <span class="s2">&quot;accounting.mode&quot;</span><span class="p">:</span>                                     <span class="n">NVSMI_ACCT_MODE</span><span class="p">,</span>
    <span class="s2">&quot;accounting.buffer_size&quot;</span><span class="p">:</span>                              <span class="n">NVSMI_ACCT_BUFFER_SIZE</span><span class="p">,</span>
    <span class="s2">&quot;driver_model.current&quot;</span><span class="p">:</span>                                <span class="n">NVSMI_DRIVER_MODEL_CUR</span><span class="p">,</span>
    <span class="s2">&quot;driver_model.pending&quot;</span><span class="p">:</span>                                <span class="n">NVSMI_DRIVER_MODEL_PENDING</span><span class="p">,</span>
    <span class="s2">&quot;vbios_version&quot;</span><span class="p">:</span>                                       <span class="n">NVSMI_VBIOS_VER</span><span class="p">,</span>
    <span class="s2">&quot;inforom.img&quot;</span><span class="p">:</span>                                         <span class="n">NVSMI_INFOROM_IMG</span><span class="p">,</span>
    <span class="s2">&quot;inforom.image&quot;</span><span class="p">:</span>                                       <span class="n">NVSMI_INFOROM_IMG</span><span class="p">,</span>
    <span class="s2">&quot;inforom.oem&quot;</span><span class="p">:</span>                                         <span class="n">NVSMI_INFOROM_OEM</span><span class="p">,</span>
    <span class="s2">&quot;inforom.ecc&quot;</span><span class="p">:</span>                                         <span class="n">NVSMI_INFOROM_ECC</span><span class="p">,</span>
    <span class="s2">&quot;inforom.pwr&quot;</span><span class="p">:</span>                                         <span class="n">NVSMI_INFOROM_PWR</span><span class="p">,</span>
    <span class="s2">&quot;inforom.power&quot;</span><span class="p">:</span>                                       <span class="n">NVSMI_INFOROM_PWR</span><span class="p">,</span>
    <span class="s2">&quot;gom.current&quot;</span><span class="p">:</span>                                         <span class="n">NVSMI_GOM_CUR</span><span class="p">,</span>
    <span class="s2">&quot;gpu_operation_mode.current&quot;</span><span class="p">:</span>                          <span class="n">NVSMI_GOM_CUR</span><span class="p">,</span>
    <span class="s2">&quot;gom.pending&quot;</span><span class="p">:</span>                                         <span class="n">NVSMI_GOM_PENDING</span><span class="p">,</span>
    <span class="s2">&quot;gpu_operation_mode.pending&quot;</span><span class="p">:</span>                          <span class="n">NVSMI_GOM_PENDING</span><span class="p">,</span>
    <span class="s2">&quot;fan.speed&quot;</span><span class="p">:</span>                                           <span class="n">NVSMI_FAN_SPEED</span><span class="p">,</span>
    <span class="s2">&quot;pstate&quot;</span><span class="p">:</span>                                              <span class="n">NVSMI_PSTATE</span><span class="p">,</span>
    <span class="s2">&quot;clocks_throttle_reasons.supported&quot;</span><span class="p">:</span>                   <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_SUPPORTED</span><span class="p">,</span>
    <span class="s2">&quot;clocks_throttle_reasons.active&quot;</span><span class="p">:</span>                      <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_ACTIVE</span><span class="p">,</span>
    <span class="s2">&quot;clocks_throttle_reasons.gpu_idle&quot;</span><span class="p">:</span>                    <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_IDLE</span><span class="p">,</span>
    <span class="s2">&quot;clocks_throttle_reasons.applications_clocks_setting&quot;</span><span class="p">:</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_APP_SETTING</span><span class="p">,</span>
    <span class="s2">&quot;clocks_throttle_reasons.sw_power_cap&quot;</span><span class="p">:</span>                <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_SW_PWR_CAP</span><span class="p">,</span>
    <span class="s2">&quot;clocks_throttle_reasons.hw_slowdown&quot;</span><span class="p">:</span>                 <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_HW_SLOWDOWN</span><span class="p">,</span>
    <span class="s2">&quot;clocks_throttle_reasons.hw_thermal_slowdown&quot;</span><span class="p">:</span>         <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_HW_THERMAL_SLOWDOWN</span><span class="p">,</span>
    <span class="s2">&quot;clocks_throttle_reasons.hw_power_brake_slowdown&quot;</span><span class="p">:</span>     <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_HW_PWR_BRAKE_SLOWDOWN</span><span class="p">,</span>
    <span class="s2">&quot;clocks_throttle_reasons.sw_thermal_slowdown&quot;</span><span class="p">:</span>         <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_SW_THERMAL_SLOWDOWN</span><span class="p">,</span>
    <span class="s2">&quot;clocks_throttle_reasons.sync_boost&quot;</span><span class="p">:</span>                  <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_SYNC_BOOST</span><span class="p">,</span>
    <span class="s2">&quot;memory.total&quot;</span><span class="p">:</span>                                        <span class="n">NVSMI_MEMORY_TOTAL</span><span class="p">,</span>
    <span class="s2">&quot;memory.used&quot;</span><span class="p">:</span>                                         <span class="n">NVSMI_MEMORY_USED</span><span class="p">,</span>
    <span class="s2">&quot;memory.free&quot;</span><span class="p">:</span>                                         <span class="n">NVSMI_MEMORY_FREE</span><span class="p">,</span>
    <span class="s2">&quot;compute_mode&quot;</span><span class="p">:</span>                                        <span class="n">NVSMI_COMPUTE_MODE</span><span class="p">,</span>
    <span class="s2">&quot;utilization.gpu&quot;</span><span class="p">:</span>                                     <span class="n">NVSMI_UTILIZATION_GPU</span><span class="p">,</span>
    <span class="s2">&quot;utilization.memory&quot;</span><span class="p">:</span>                                  <span class="n">NVSMI_UTILIZATION_MEM</span><span class="p">,</span>
    <span class="s2">&quot;encoder.stats.sessionCount&quot;</span><span class="p">:</span>                          <span class="n">NVSMI_ENCODER_STATS_SESSIONCOUNT</span><span class="p">,</span>
    <span class="s2">&quot;encoder.stats.averageFps&quot;</span><span class="p">:</span>                            <span class="n">NVSMI_ENCODER_STATS_AVG_EPS</span><span class="p">,</span>
    <span class="s2">&quot;encoder.stats.averageLatency&quot;</span><span class="p">:</span>                        <span class="n">NVSMI_ENCODER_STATS_AVG_LATENCY</span><span class="p">,</span>
    <span class="s2">&quot;ecc.mode.current&quot;</span><span class="p">:</span>                                    <span class="n">NVSMI_ECC_MODE_CUR</span><span class="p">,</span>
    <span class="s2">&quot;ecc.mode.pending&quot;</span><span class="p">:</span>                                    <span class="n">NVSMI_ECC_MODE_PENDING</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.corrected.volatile.device_memory&quot;</span><span class="p">:</span>         <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_DEV_MEM</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.corrected.volatile.register_file&quot;</span><span class="p">:</span>         <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_REGFILE</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.corrected.volatile.l1_cache&quot;</span><span class="p">:</span>              <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L1CACHE</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.corrected.volatile.l2_cache&quot;</span><span class="p">:</span>              <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L2CACHE</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.corrected.volatile.texture_memory&quot;</span><span class="p">:</span>        <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_TEXTURE</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.corrected.volatile.total&quot;</span><span class="p">:</span>                 <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_TOTAL</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.corrected.aggregate.device_memory&quot;</span><span class="p">:</span>        <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_DEV_MEM</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.corrected.aggregate.register_file&quot;</span><span class="p">:</span>        <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_REGFILE</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.corrected.aggregate.l1_cache&quot;</span><span class="p">:</span>             <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L1CACHE</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.corrected.aggregate.l2_cache&quot;</span><span class="p">:</span>             <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L2CACHE</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.corrected.aggregate.texture_memory&quot;</span><span class="p">:</span>       <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TEXTURE</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.corrected.aggregate.total&quot;</span><span class="p">:</span>                <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TOTAL</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.uncorrected.volatile.device_memory&quot;</span><span class="p">:</span>       <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_DEV_MEM</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.uncorrected.volatile.register_file&quot;</span><span class="p">:</span>       <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_REGFILE</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.uncorrected.volatile.l1_cache&quot;</span><span class="p">:</span>            <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_L1CACHE</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.uncorrected.volatile.l2_cache&quot;</span><span class="p">:</span>            <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_L2CACHE</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.uncorrected.volatile.texture_memory&quot;</span><span class="p">:</span>      <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_TEXTURE</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.uncorrected.volatile.total&quot;</span><span class="p">:</span>               <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_TOTAL</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.uncorrected.aggregate.device_memory&quot;</span><span class="p">:</span>      <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_DEV_MEM</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.uncorrected.aggregate.register_file&quot;</span><span class="p">:</span>      <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_REGFILE</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.uncorrected.aggregate.l1_cache&quot;</span><span class="p">:</span>           <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_L1CACHE</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.uncorrected.aggregate.l2_cache&quot;</span><span class="p">:</span>           <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_L2CACHE</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.uncorrected.aggregate.texture_memory&quot;</span><span class="p">:</span>     <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_TEXTURE</span><span class="p">,</span>
    <span class="s2">&quot;ecc.errors.uncorrected.aggregate.total&quot;</span><span class="p">:</span>              <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_TOTAL</span><span class="p">,</span>
    <span class="s2">&quot;retired_pages.single_bit_ecc.count&quot;</span><span class="p">:</span>                  <span class="n">NVSMI_RETIREDPAGES_SINGLE_BIT_ECC_COUNT</span><span class="p">,</span>
    <span class="s2">&quot;retired_pages.sbe&quot;</span><span class="p">:</span>                                   <span class="n">NVSMI_RETIREDPAGES_SINGLE_BIT_ECC_COUNT</span><span class="p">,</span>
    <span class="s2">&quot;retired_pages.double_bit.count&quot;</span><span class="p">:</span>                      <span class="n">NVSMI_RETIREDPAGES_DOUBLE_BIT_ECC_COUNT</span><span class="p">,</span>
    <span class="s2">&quot;retired_pages.dbe&quot;</span><span class="p">:</span>                                   <span class="n">NVSMI_RETIREDPAGES_DOUBLE_BIT_ECC_COUNT</span><span class="p">,</span>
    <span class="s2">&quot;retired_pages.pending&quot;</span><span class="p">:</span>                               <span class="n">NVSMI_RETIREDPAGES_PENDING</span><span class="p">,</span>
    <span class="s2">&quot;temperature.gpu&quot;</span><span class="p">:</span>                                     <span class="n">NVSMI_TEMPERATURE_GPU</span><span class="p">,</span>
    <span class="s2">&quot;temperature.memory&quot;</span><span class="p">:</span>                                  <span class="n">NVSMI_TEMPERATURE_MEMORY</span><span class="p">,</span>
    <span class="s2">&quot;power.management&quot;</span><span class="p">:</span>                                    <span class="n">NVSMI_POWER_MGMT</span><span class="p">,</span>
    <span class="s2">&quot;power.draw&quot;</span><span class="p">:</span>                                          <span class="n">NVSMI_POWER_DRAW</span><span class="p">,</span>
    <span class="s2">&quot;power.limit&quot;</span><span class="p">:</span>                                         <span class="n">NVSMI_POWER_LIMIT</span><span class="p">,</span>
    <span class="s2">&quot;enforced.power.limit&quot;</span><span class="p">:</span>                                <span class="n">NVSMI_POWER_LIMIT_ENFORCED</span><span class="p">,</span>
    <span class="s2">&quot;power.default_limit&quot;</span><span class="p">:</span>                                 <span class="n">NVSMI_POWER_LIMIT_DEFAULT</span><span class="p">,</span>
    <span class="s2">&quot;power.min_limit&quot;</span><span class="p">:</span>                                     <span class="n">NVSMI_POWER_LIMIT_MIN</span><span class="p">,</span>
    <span class="s2">&quot;power.max_limit&quot;</span><span class="p">:</span>                                     <span class="n">NVSMI_POWER_LIMIT_MAX</span><span class="p">,</span>
    <span class="s2">&quot;clocks.current.graphics&quot;</span><span class="p">:</span>                             <span class="n">NVSMI_CLOCKS_GRAPHICS_CUR</span><span class="p">,</span>
    <span class="s2">&quot;clocks.gr&quot;</span><span class="p">:</span>                                           <span class="n">NVSMI_CLOCKS_GRAPHICS_CUR</span><span class="p">,</span>
    <span class="s2">&quot;clocks.current.sm&quot;</span><span class="p">:</span>                                   <span class="n">NVSMI_CLOCKS_SM_CUR</span><span class="p">,</span>
    <span class="s2">&quot;clocks.sm&quot;</span><span class="p">:</span>                                           <span class="n">NVSMI_CLOCKS_SM_CUR</span><span class="p">,</span>
    <span class="s2">&quot;clocks.current.memory&quot;</span><span class="p">:</span>                               <span class="n">NVSMI_CLOCKS_MEMORY_CUR</span><span class="p">,</span>
    <span class="s2">&quot;clocks.mem&quot;</span><span class="p">:</span>                                          <span class="n">NVSMI_CLOCKS_MEMORY_CUR</span><span class="p">,</span>
    <span class="s2">&quot;clocks.current.video&quot;</span><span class="p">:</span>                                <span class="n">NVSMI_CLOCKS_VIDEO_CUR</span><span class="p">,</span>
    <span class="s2">&quot;clocks.video&quot;</span><span class="p">:</span>                                        <span class="n">NVSMI_CLOCKS_VIDEO_CUR</span><span class="p">,</span>
    <span class="s2">&quot;clocks.applications.graphics&quot;</span><span class="p">:</span>                        <span class="n">NVSMI_CLOCKS_APPL_GRAPHICS</span><span class="p">,</span>
    <span class="s2">&quot;clocks.applications.gr&quot;</span><span class="p">:</span>                              <span class="n">NVSMI_CLOCKS_APPL_GRAPHICS</span><span class="p">,</span>
    <span class="s2">&quot;clocks.applications.memory&quot;</span><span class="p">:</span>                          <span class="n">NVSMI_CLOCKS_APPL_MEMORY</span><span class="p">,</span>
    <span class="s2">&quot;clocks.applications.mem&quot;</span><span class="p">:</span>                             <span class="n">NVSMI_CLOCKS_APPL_MEMORY</span><span class="p">,</span>
    <span class="s2">&quot;clocks.default_applications.graphics&quot;</span><span class="p">:</span>                <span class="n">NVSMI_CLOCKS_APPL_GRAPHICS_DEFAULT</span><span class="p">,</span>
    <span class="s2">&quot;clocks.default_applications.gr&quot;</span><span class="p">:</span>                      <span class="n">NVSMI_CLOCKS_APPL_GRAPHICS_DEFAULT</span><span class="p">,</span>
    <span class="s2">&quot;clocks.default_applications.memory&quot;</span><span class="p">:</span>                  <span class="n">NVSMI_CLOCKS_APPL_MEMORY_DEFAULT</span><span class="p">,</span>
    <span class="s2">&quot;clocks.default_applications.mem&quot;</span><span class="p">:</span>                     <span class="n">NVSMI_CLOCKS_APPL_MEMORY_DEFAULT</span><span class="p">,</span>
    <span class="s2">&quot;clocks.max.graphics&quot;</span><span class="p">:</span>                                 <span class="n">NVSMI_CLOCKS_GRAPHICS_MAX</span><span class="p">,</span>
    <span class="s2">&quot;clocks.max.gr&quot;</span><span class="p">:</span>                                       <span class="n">NVSMI_CLOCKS_GRAPHICS_MAX</span><span class="p">,</span>
    <span class="s2">&quot;clocks.max.sm&quot;</span><span class="p">:</span>                                       <span class="n">NVSMI_CLOCKS_SM_MAX</span><span class="p">,</span>
    <span class="s2">&quot;clocks.max.sm&quot;</span><span class="p">:</span>                                       <span class="n">NVSMI_CLOCKS_SM_MAX</span><span class="p">,</span>
    <span class="s2">&quot;clocks.max.memory&quot;</span><span class="p">:</span>                                   <span class="n">NVSMI_CLOCKS_MEMORY_MAX</span><span class="p">,</span>
    <span class="s2">&quot;clocks.max.mem&quot;</span><span class="p">:</span>                                      <span class="n">NVSMI_CLOCKS_MEMORY_MAX</span><span class="p">,</span>
    <span class="s2">&quot;supported-clocks&quot;</span><span class="p">:</span>                                    <span class="n">NVSMI_CLOCKS_SUPPORTED</span><span class="p">,</span>
    <span class="s2">&quot;compute-apps&quot;</span><span class="p">:</span>                                        <span class="n">NVSMI_COMPUTE_APPS</span><span class="p">,</span>
    <span class="s2">&quot;accounted-apps&quot;</span><span class="p">:</span>                                      <span class="n">NVSMI_ACCOUNTED_APPS</span><span class="p">,</span>
    <span class="s2">&quot;clocks&quot;</span><span class="p">:</span>                                              <span class="n">NVSMI_CLOCKS_POLICY</span><span class="p">,</span>
    <span class="p">}</span>

<span class="n">NVSMI_BRAND_NAMES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">NVML_BRAND_UNKNOWN</span><span class="p">:</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">,</span>
    <span class="n">NVML_BRAND_QUADRO</span><span class="p">:</span>  <span class="s2">&quot;Quadro&quot;</span><span class="p">,</span>
    <span class="n">NVML_BRAND_TESLA</span><span class="p">:</span>   <span class="s2">&quot;Tesla&quot;</span><span class="p">,</span>
    <span class="n">NVML_BRAND_NVS</span><span class="p">:</span>     <span class="s2">&quot;NVS&quot;</span><span class="p">,</span>
    <span class="n">NVML_BRAND_GRID</span><span class="p">:</span>    <span class="s2">&quot;Grid&quot;</span><span class="p">,</span>
    <span class="n">NVML_BRAND_GEFORCE</span><span class="p">:</span> <span class="s2">&quot;GeForce&quot;</span><span class="p">,</span>
    <span class="p">}</span>


<span class="c1">## ========================================================================== ##</span>
<span class="c1">##                                                                            ##</span>
<span class="c1">##                             NvidiaSMI Class                                ##</span>
<span class="c1">##                                                                            ##</span>
<span class="c1">## ========================================================================== ##</span>


<div class="viewcode-block" id="NVMLError_NotSupported"><a class="viewcode-back" href="../../../../generated/heimdallr.utilities.nvidia.smi_parsing.NVMLError_NotSupported.html#heimdallr.utilities.nvidia.smi_parsing.NVMLError_NotSupported">[docs]</a><span class="k">class</span> <span class="nc">NVMLError_NotSupported</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
  <span class="k">pass</span></div>


<div class="viewcode-block" id="NvidiaSMI"><a class="viewcode-back" href="../../../../generated/heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.html#heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI">[docs]</a><span class="k">class</span> <span class="nc">NvidiaSMI</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;description&quot;&quot;&quot;</span>

  <span class="n">__instance</span> <span class="o">=</span> <span class="kc">None</span>
  <span class="n">__handles</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="NvidiaSMI.loop_async"><a class="viewcode-back" href="../../../../generated/heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.html#heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.loop_async">[docs]</a>  <span class="k">class</span> <span class="nc">loop_async</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;description&quot;&quot;&quot;</span>

    <span class="n">__last_result</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">__task</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">__abort</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">__callback_chain</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_in_milliseconds</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">filter</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">callback</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__abort</span> <span class="o">=</span> <span class="kc">False</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__callback_chain</span> <span class="o">=</span> <span class="n">callback</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">__task</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span>
          <span class="n">target</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">loop_async</span><span class="o">.</span><span class="n">__loop_task</span><span class="p">,</span>
          <span class="n">args</span> <span class="o">=</span> <span class="p">(</span>
              <span class="bp">self</span><span class="p">,</span>
              <span class="n">time_in_milliseconds</span><span class="p">,</span>
              <span class="nb">filter</span><span class="p">,</span>
              <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">loop_async</span><span class="o">.</span><span class="n">__callback</span><span class="p">,</span>
              <span class="p">),</span>
          <span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__task</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__abort</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__callback_chain</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__loop_task</span><span class="p">(</span>
        <span class="n">async_results</span><span class="p">,</span> <span class="n">time_in_milliseconds</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">filter</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">callback</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="p">):</span>
      <span class="n">delay_seconds</span> <span class="o">=</span> <span class="n">time_in_milliseconds</span> <span class="o">/</span> <span class="mi">1000</span>
      <span class="n">nvsmi</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">getInstance</span><span class="p">()</span>

      <span class="k">while</span> <span class="n">async_results</span><span class="o">.</span><span class="n">is_aborted</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">nvsmi</span><span class="o">.</span><span class="n">DeviceQuery</span><span class="p">(</span><span class="nb">filter</span><span class="p">)</span>
        <span class="n">async_results</span><span class="o">.</span><span class="n">__last_results</span> <span class="o">=</span> <span class="n">results</span>
        <span class="k">if</span> <span class="n">callback</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
          <span class="n">callback</span><span class="p">(</span><span class="n">async_results</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>

        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_seconds</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__last_result</span> <span class="o">=</span> <span class="n">result</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__callback_chain</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__callback_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

<div class="viewcode-block" id="NvidiaSMI.loop_async.cancel"><a class="viewcode-back" href="../../../../generated/heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.html#heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.loop_async.cancel">[docs]</a>    <span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;description&quot;&quot;&quot;</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__abort</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__task</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__task</span><span class="o">.</span><span class="n">join</span><span class="p">()</span></div>

<div class="viewcode-block" id="NvidiaSMI.loop_async.is_aborted"><a class="viewcode-back" href="../../../../generated/heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.html#heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.loop_async.is_aborted">[docs]</a>    <span class="k">def</span> <span class="nf">is_aborted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;description&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__abort</span></div>

<div class="viewcode-block" id="NvidiaSMI.loop_async.result"><a class="viewcode-back" href="../../../../generated/heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.html#heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.loop_async.result">[docs]</a>    <span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;description&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__last_result</span></div></div>

<div class="viewcode-block" id="NvidiaSMI.getInstance"><a class="viewcode-back" href="../../../../generated/heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.html#heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.getInstance">[docs]</a>  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">getInstance</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Static access method.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__instance</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">NvidiaSMI</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__instance</span></div>

<div class="viewcode-block" id="NvidiaSMI.loop"><a class="viewcode-back" href="../../../../generated/heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.html#heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.loop">[docs]</a>  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="n">time_in_milliseconds</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">filter</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">callback</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;description&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">loop_async</span><span class="p">(</span><span class="n">time_in_milliseconds</span><span class="p">,</span> <span class="nb">filter</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span></div>

<div class="viewcode-block" id="NvidiaSMI.__init__"><a class="viewcode-back" href="../../../../generated/heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.html#heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.__init__">[docs]</a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Virtually private constructor.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__instance</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;This class is a singleton, use getInstance()&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__instance</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">if</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handles</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handles</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__initialize_nvml</span><span class="p">()</span></div>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">__initialize_nvml</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Initialize NVML bindings.&quot;&quot;&quot;</span>
    <span class="n">nvmlInit</span><span class="p">()</span>
    <span class="n">deviceCount</span> <span class="o">=</span> <span class="n">nvmlDeviceGetCount</span><span class="p">()</span>
    <span class="n">handles</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">deviceCount</span><span class="p">):</span>
      <span class="n">handles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nvmlDeviceGetHandleByIndex</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">handles</span>

  <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__instance</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__instance</span> <span class="o">==</span> <span class="bp">self</span><span class="p">):</span>
      <span class="k">del</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__instance</span>
      <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__instance</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handles</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="n">nvmlShutdown</span><span class="p">()</span>

  <span class="c1">#</span>
  <span class="c1"># Helper functions</span>
  <span class="c1">#</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">__fromDeviceQueryString</span><span class="p">(</span><span class="n">queryString</span><span class="p">):</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="n">queryString</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
      <span class="n">ps</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">ps</span> <span class="ow">in</span> <span class="n">NVSMI_QUERY_GPU</span><span class="p">:</span>
        <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NVSMI_QUERY_GPU</span><span class="p">[</span><span class="n">ps</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">values</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">__xmlGetEccByType</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">counterType</span><span class="p">,</span> <span class="n">errorType</span><span class="p">):</span>
    <span class="n">strResult</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="n">deviceMemory</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMemoryErrorCounter</span><span class="p">(</span>
          <span class="n">handle</span><span class="p">,</span> <span class="n">errorType</span><span class="p">,</span> <span class="n">counterType</span><span class="p">,</span> <span class="n">NVML_MEMORY_LOCATION_DEVICE_MEMORY</span>
          <span class="p">)</span>
    <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="n">deviceMemory</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="n">strResult</span> <span class="o">+=</span> <span class="p">(</span>
        <span class="s2">&quot;          &lt;device_memory&gt;&quot;</span>
        <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">deviceMemory</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;&lt;/device_memory&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="n">registerFile</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMemoryErrorCounter</span><span class="p">(</span>
          <span class="n">handle</span><span class="p">,</span> <span class="n">errorType</span><span class="p">,</span> <span class="n">counterType</span><span class="p">,</span> <span class="n">NVML_MEMORY_LOCATION_REGISTER_FILE</span>
          <span class="p">)</span>
    <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="n">registerFile</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

    <span class="n">strResult</span> <span class="o">+=</span> <span class="p">(</span>
        <span class="s2">&quot;          &lt;register_file&gt;&quot;</span>
        <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">registerFile</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;&lt;/register_file&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="n">l1Cache</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMemoryErrorCounter</span><span class="p">(</span>
          <span class="n">handle</span><span class="p">,</span> <span class="n">errorType</span><span class="p">,</span> <span class="n">counterType</span><span class="p">,</span> <span class="n">NVML_MEMORY_LOCATION_L1_CACHE</span>
          <span class="p">)</span>
    <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="n">l1Cache</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="n">strResult</span> <span class="o">+=</span> <span class="p">(</span>
        <span class="s2">&quot;          &lt;l1_cache&gt;&quot;</span> <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">l1Cache</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&lt;/l1_cache&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="n">l2Cache</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMemoryErrorCounter</span><span class="p">(</span>
          <span class="n">handle</span><span class="p">,</span> <span class="n">errorType</span><span class="p">,</span> <span class="n">counterType</span><span class="p">,</span> <span class="n">NVML_MEMORY_LOCATION_L2_CACHE</span>
          <span class="p">)</span>
    <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="n">l2Cache</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="n">strResult</span> <span class="o">+=</span> <span class="p">(</span>
        <span class="s2">&quot;          &lt;l2_cache&gt;&quot;</span> <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">l2Cache</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&lt;/l2_cache&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="n">textureMemory</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMemoryErrorCounter</span><span class="p">(</span>
          <span class="n">handle</span><span class="p">,</span> <span class="n">errorType</span><span class="p">,</span> <span class="n">counterType</span><span class="p">,</span> <span class="n">NVML_MEMORY_LOCATION_TEXTURE_MEMORY</span>
          <span class="p">)</span>
    <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="n">textureMemory</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="n">strResult</span> <span class="o">+=</span> <span class="p">(</span>
        <span class="s2">&quot;          &lt;texture_memory&gt;&quot;</span>
        <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">textureMemory</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;&lt;/texture_memory&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="n">count</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
          <span class="n">nvmlDeviceGetTotalEccErrors</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">errorType</span><span class="p">,</span> <span class="n">counterType</span><span class="p">)</span>
          <span class="p">)</span>
    <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="n">count</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="n">strResult</span> <span class="o">+=</span> <span class="s2">&quot;          &lt;total&gt;&quot;</span> <span class="o">+</span> <span class="n">count</span> <span class="o">+</span> <span class="s2">&quot;&lt;/total&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">strResult</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">__GetEccByType</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">counterType</span><span class="p">,</span> <span class="n">errorType</span><span class="p">):</span>
    <span class="n">strResult</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="n">eccByType</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">deviceMemory</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMemoryErrorCounter</span><span class="p">(</span>
          <span class="n">handle</span><span class="p">,</span> <span class="n">errorType</span><span class="p">,</span> <span class="n">counterType</span><span class="p">,</span> <span class="n">NVML_MEMORY_LOCATION_DEVICE_MEMORY</span>
          <span class="p">)</span>
    <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="n">deviceMemory</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

    <span class="n">eccByType</span><span class="p">[</span><span class="s2">&quot;device_memory&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deviceMemory</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="n">registerFile</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMemoryErrorCounter</span><span class="p">(</span>
          <span class="n">handle</span><span class="p">,</span> <span class="n">errorType</span><span class="p">,</span> <span class="n">counterType</span><span class="p">,</span> <span class="n">NVML_MEMORY_LOCATION_REGISTER_FILE</span>
          <span class="p">)</span>
    <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="n">registerFile</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

    <span class="n">eccByType</span><span class="p">[</span><span class="s2">&quot;register_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">registerFile</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="n">l1Cache</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMemoryErrorCounter</span><span class="p">(</span>
          <span class="n">handle</span><span class="p">,</span> <span class="n">errorType</span><span class="p">,</span> <span class="n">counterType</span><span class="p">,</span> <span class="n">NVML_MEMORY_LOCATION_L1_CACHE</span>
          <span class="p">)</span>
    <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="n">l1Cache</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="n">eccByType</span><span class="p">[</span><span class="s2">&quot;l1_cache&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l1Cache</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="n">l2Cache</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMemoryErrorCounter</span><span class="p">(</span>
          <span class="n">handle</span><span class="p">,</span> <span class="n">errorType</span><span class="p">,</span> <span class="n">counterType</span><span class="p">,</span> <span class="n">NVML_MEMORY_LOCATION_L2_CACHE</span>
          <span class="p">)</span>
    <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="n">l2Cache</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="n">eccByType</span><span class="p">[</span><span class="s2">&quot;l2_cache&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l2Cache</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="n">textureMemory</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMemoryErrorCounter</span><span class="p">(</span>
          <span class="n">handle</span><span class="p">,</span> <span class="n">errorType</span><span class="p">,</span> <span class="n">counterType</span><span class="p">,</span> <span class="n">NVML_MEMORY_LOCATION_TEXTURE_MEMORY</span>
          <span class="p">)</span>
    <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="n">textureMemory</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="n">eccByType</span><span class="p">[</span><span class="s2">&quot;texture_memory&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">textureMemory</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="n">count</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
          <span class="n">nvmlDeviceGetTotalEccErrors</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">errorType</span><span class="p">,</span> <span class="n">counterType</span><span class="p">)</span>
          <span class="p">)</span>
    <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="n">count</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="n">eccByType</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span>

    <span class="k">return</span> <span class="n">eccByType</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">__xmlGetEccByCounter</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">counterType</span><span class="p">,</span> <span class="nb">filter</span><span class="p">):</span>
    <span class="n">eccByCounter</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_DEV_MEM</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_REGFILE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L1CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L2CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_TEXTURE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_DEV_MEM</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_REGFILE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L1CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L2CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TEXTURE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TOTAL</span> <span class="ow">in</span> <span class="nb">filter</span>
    <span class="p">):</span>
      <span class="n">eccByCounter</span> <span class="o">+=</span> <span class="s2">&quot;        &lt;single_bit&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="n">eccByCounter</span> <span class="o">+=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
          <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__xmlGetEccByType</span><span class="p">(</span>
              <span class="n">handle</span><span class="p">,</span> <span class="n">counterType</span><span class="p">,</span> <span class="n">NVML_MEMORY_ERROR_TYPE_CORRECTED</span>
              <span class="p">)</span>
          <span class="p">)</span>
      <span class="n">eccByCounter</span> <span class="o">+=</span> <span class="s2">&quot;        &lt;/single_bit&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_DEV_MEM</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_REGFILE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L1CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L2CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_TEXTURE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_DEV_MEM</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_REGFILE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L1CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L2CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TEXTURE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TOTAL</span> <span class="ow">in</span> <span class="nb">filter</span>
    <span class="p">):</span>
      <span class="n">eccByCounter</span> <span class="o">+=</span> <span class="s2">&quot;        &lt;double_bit&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="n">eccByCounter</span> <span class="o">+=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
          <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__xmlGetEccByType</span><span class="p">(</span>
              <span class="n">handle</span><span class="p">,</span> <span class="n">counterType</span><span class="p">,</span> <span class="n">NVML_MEMORY_ERROR_TYPE_UNCORRECTED</span>
              <span class="p">)</span>
          <span class="p">)</span>
      <span class="n">eccByCounter</span> <span class="o">+=</span> <span class="s2">&quot;        &lt;/double_bit&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">eccByCounter</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">__GetEccByCounter</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">counterType</span><span class="p">,</span> <span class="nb">filter</span><span class="p">):</span>
    <span class="n">eccByCounter</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_DEV_MEM</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_REGFILE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L1CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L2CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_TEXTURE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_DEV_MEM</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_REGFILE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L1CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L2CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TEXTURE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TOTAL</span> <span class="ow">in</span> <span class="nb">filter</span>
    <span class="p">):</span>
      <span class="n">eccByCounter</span><span class="p">[</span><span class="s2">&quot;single_bit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__GetEccByType</span><span class="p">(</span>
          <span class="n">handle</span><span class="p">,</span> <span class="n">counterType</span><span class="p">,</span> <span class="n">NVML_MEMORY_ERROR_TYPE_CORRECTED</span>
          <span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_DEV_MEM</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_REGFILE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L1CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L2CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_TEXTURE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_DEV_MEM</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_REGFILE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L1CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L2CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TEXTURE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TOTAL</span> <span class="ow">in</span> <span class="nb">filter</span>
    <span class="p">):</span>
      <span class="n">eccByCounter</span><span class="p">[</span><span class="s2">&quot;double_bit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__GetEccByType</span><span class="p">(</span>
          <span class="n">handle</span><span class="p">,</span> <span class="n">counterType</span><span class="p">,</span> <span class="n">NVML_MEMORY_ERROR_TYPE_UNCORRECTED</span>
          <span class="p">)</span>

    <span class="k">return</span> <span class="n">eccByCounter</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">__xmlGetEcc</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">filter</span><span class="p">):</span>
    <span class="n">ecc</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">includeEcc</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_DEV_MEM</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_REGFILE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L1CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L2CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_TEXTURE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_DEV_MEM</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_REGFILE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_L1CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_L2CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_TEXTURE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_TOTAL</span> <span class="ow">in</span> <span class="nb">filter</span>
    <span class="p">):</span>
      <span class="n">ecc</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;volatile&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="n">ecc</span> <span class="o">+=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
          <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__xmlGetEccByCounter</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_VOLATILE_ECC</span><span class="p">,</span> <span class="nb">filter</span><span class="p">)</span>
          <span class="p">)</span>
      <span class="n">ecc</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;/volatile&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="n">includeEcc</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_DEV_MEM</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_REGFILE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L1CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L2CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TEXTURE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TOTAL</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_DEV_MEM</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_REGFILE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_L1CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_L2CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_TEXTURE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_TOTAL</span> <span class="ow">in</span> <span class="nb">filter</span>
    <span class="p">):</span>
      <span class="n">ecc</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;aggregate&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="n">ecc</span> <span class="o">+=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
          <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__xmlGetEccByCounter</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_AGGREGATE_ECC</span><span class="p">,</span> <span class="nb">filter</span><span class="p">)</span>
          <span class="p">)</span>
      <span class="n">ecc</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;/aggregate&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="n">includeEcc</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="n">ecc</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ecc</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">includeEcc</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">__GetEcc</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">filter</span><span class="p">):</span>
    <span class="n">ecc</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">includeEcc</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_DEV_MEM</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_REGFILE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L1CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_L2CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_VOLATILE_TEXTURE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_DEV_MEM</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_REGFILE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_L1CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_L2CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_TEXTURE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_VOLATILE_TOTAL</span> <span class="ow">in</span> <span class="nb">filter</span>
    <span class="p">):</span>
      <span class="n">ecc</span><span class="p">[</span><span class="s2">&quot;volatile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__GetEccByCounter</span><span class="p">(</span>
          <span class="n">handle</span><span class="p">,</span> <span class="n">NVML_VOLATILE_ECC</span><span class="p">,</span> <span class="nb">filter</span>
          <span class="p">)</span>
      <span class="n">includeEcc</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_DEV_MEM</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_REGFILE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L1CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_L2CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TEXTURE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_CORRECTED_AGGREGATE_TOTAL</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_DEV_MEM</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_REGFILE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_L1CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_L2CACHE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_TEXTURE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="ow">or</span> <span class="n">NVSMI_ECC_ERROR_UNCORRECTED_AGGREGATE_TOTAL</span> <span class="ow">in</span> <span class="nb">filter</span>
    <span class="p">):</span>
      <span class="n">ecc</span><span class="p">[</span><span class="s2">&quot;aggregate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__GetEccByCounter</span><span class="p">(</span>
          <span class="n">handle</span><span class="p">,</span> <span class="n">NVML_AGGREGATE_ECC</span><span class="p">,</span> <span class="nb">filter</span>
          <span class="p">)</span>
      <span class="n">includeEcc</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="n">ecc</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ecc</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">includeEcc</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">__xmlGetRetiredPagesByCause</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">cause</span><span class="p">):</span>
    <span class="n">retiredPagedByCause</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="n">error</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">pages</span> <span class="o">=</span> <span class="n">nvmlDeviceGetRetiredPages</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">cause</span><span class="p">)</span>
      <span class="n">count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
          <span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">pages</span><span class="p">)</span>
          <span class="p">)</span>  <span class="c1"># [py2] count = nvidia_smi.__toString(len(pages))</span>
    <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="n">error</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
      <span class="n">pages</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">retiredPagedByCause</span> <span class="o">+=</span> <span class="p">(</span>
        <span class="s2">&quot;        &lt;retired_count&gt;&quot;</span>
        <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">&quot;&lt;/retired_count&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">pages</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">retiredPagedByCause</span> <span class="o">+=</span> <span class="s2">&quot;        &lt;retired_page_addresses&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">pages</span><span class="p">:</span>
        <span class="n">retiredPagedByCause</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="s2">&quot;          &lt;retired_page_address&gt;&quot;</span>
            <span class="o">+</span> <span class="s2">&quot;0x</span><span class="si">%016x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">page</span>
            <span class="o">+</span> <span class="s2">&quot;&lt;/retired_page_address&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
      <span class="n">retiredPagedByCause</span> <span class="o">+=</span> <span class="s2">&quot;        &lt;/retired_page_addresses&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">retiredPagedByCause</span> <span class="o">+=</span> <span class="p">(</span>
          <span class="s2">&quot;        &lt;retired_page_addresses&gt;&quot;</span>
          <span class="o">+</span> <span class="n">error</span>
          <span class="o">+</span> <span class="s2">&quot;&lt;/retired_page_addresses&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="p">)</span>

    <span class="k">return</span> <span class="n">retiredPagedByCause</span> <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">__GetRetiredPagesByCause</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">cause</span><span class="p">):</span>
    <span class="n">retiredPagedByCause</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">error</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">pages</span> <span class="o">=</span> <span class="n">nvmlDeviceGetRetiredPages</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">cause</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="n">error</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
      <span class="n">pages</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">retiredPageAddresses</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">pages</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">ii</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">pages</span><span class="p">:</span>
        <span class="n">retiredPageAddresses</span><span class="p">[</span><span class="s2">&quot;retired_page_address_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ii</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;0x</span><span class="si">%016x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">page</span>
        <span class="p">)</span>
        <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">retiredPageAddresses</span><span class="p">[</span><span class="s2">&quot;Error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">error</span>

    <span class="n">retiredPagedByCause</span><span class="p">[</span><span class="s2">&quot;retired_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">count</span>
    <span class="n">retiredPagedByCause</span><span class="p">[</span><span class="s2">&quot;retired_page_addresses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">retiredPageAddresses</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">retiredPageAddresses</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">retiredPagedByCause</span> <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">__xmlGetRetiredPages</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">filter</span><span class="p">):</span>
    <span class="n">retiredPages</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">includeRetiredPages</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">causes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;multiple_single_bit_retirement&quot;</span><span class="p">,</span> <span class="s2">&quot;double_bit_retirement&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NVML_PAGE_RETIREMENT_CAUSE_COUNT</span><span class="p">):</span>
      <span class="k">if</span> <span class="p">(</span>
          <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
          <span class="ow">or</span> <span class="p">(</span><span class="n">NVSMI_RETIREDPAGES_SINGLE_BIT_ECC_COUNT</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">and</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
          <span class="ow">or</span> <span class="p">(</span><span class="n">NVSMI_RETIREDPAGES_DOUBLE_BIT_ECC_COUNT</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">and</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
      <span class="p">):</span>
        <span class="n">retiredPages</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;&quot;</span> <span class="o">+</span> <span class="n">causes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">retiredPages</span> <span class="o">+=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__xmlGetRetiredPagesByCause</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
        <span class="n">retiredPages</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;/&quot;</span> <span class="o">+</span> <span class="n">causes</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">includeRetiredPages</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_RETIREDPAGES_PENDING</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
      <span class="n">retiredPages</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;pending_retirement&gt;&quot;</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">NVML_FEATURE_DISABLED</span> <span class="o">==</span> <span class="n">nvmlDeviceGetRetiredPagesPendingStatus</span><span class="p">(</span>
            <span class="n">handle</span>
            <span class="p">):</span>
          <span class="n">retiredPages</span> <span class="o">+=</span> <span class="s2">&quot;No&quot;</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">retiredPages</span> <span class="o">+=</span> <span class="s2">&quot;Yes&quot;</span>
      <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">retiredPages</span> <span class="o">+=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
      <span class="n">retiredPages</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/pending_retirement&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="n">includeRetiredPages</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="n">retiredPages</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">retiredPages</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span> <span class="n">includeRetiredPages</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">__GetRetiredPages</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">filter</span><span class="p">):</span>
    <span class="n">retiredPages</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">includeRetiredPages</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">causes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;multiple_single_bit_retirement&quot;</span><span class="p">,</span> <span class="s2">&quot;double_bit_retirement&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NVML_PAGE_RETIREMENT_CAUSE_COUNT</span><span class="p">):</span>
      <span class="k">if</span> <span class="p">(</span>
          <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
          <span class="ow">or</span> <span class="p">(</span><span class="n">NVSMI_RETIREDPAGES_SINGLE_BIT_ECC_COUNT</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">and</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
          <span class="ow">or</span> <span class="p">(</span><span class="n">NVSMI_RETIREDPAGES_DOUBLE_BIT_ECC_COUNT</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">and</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
      <span class="p">):</span>
        <span class="n">retiredPages</span><span class="p">[</span><span class="n">causes</span><span class="p">[</span><span class="n">idx</span><span class="p">]]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__GetRetiredPagesByCause</span><span class="p">(</span>
            <span class="n">handle</span><span class="p">,</span> <span class="n">idx</span>
            <span class="p">)</span>
        <span class="n">includeRetiredPages</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_RETIREDPAGES_PENDING</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
      <span class="n">pending_retirement</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">NVML_FEATURE_DISABLED</span> <span class="o">==</span> <span class="n">nvmlDeviceGetRetiredPagesPendingStatus</span><span class="p">(</span>
            <span class="n">handle</span>
            <span class="p">):</span>
          <span class="n">pending_retirement</span> <span class="o">=</span> <span class="s2">&quot;No&quot;</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">pending_retirement</span> <span class="o">=</span> <span class="s2">&quot;Yes&quot;</span>
      <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="n">pending_retirement</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
      <span class="n">retiredPages</span><span class="p">[</span><span class="s2">&quot;pending_retirement&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pending_retirement</span>
      <span class="n">includeRetiredPages</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="n">retiredPages</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">retiredPages</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">includeRetiredPages</span><span class="p">,</span>
        <span class="p">)</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">__toStrGOM</span><span class="p">(</span><span class="n">mode</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">NVML_GOM_ALL_ON</span><span class="p">:</span>
      <span class="k">return</span> <span class="s2">&quot;All On&quot;</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">NVML_GOM_COMPUTE</span><span class="p">:</span>
      <span class="k">return</span> <span class="s2">&quot;Compute&quot;</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">NVML_GOM_LOW_DP</span><span class="p">:</span>
      <span class="k">return</span> <span class="s2">&quot;Low Double Precision&quot;</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="s2">&quot;Unknown&quot;</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">__xmlGetClocksThrottleReasons</span><span class="p">(</span><span class="n">handle</span><span class="p">):</span>
    <span class="n">throttleReasons</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="n">nvmlClocksThrottleReasonGpuIdle</span><span class="p">,</span> <span class="s2">&quot;clocks_throttle_reason_gpu_idle&quot;</span><span class="p">],</span>
        <span class="p">[</span>
            <span class="n">nvmlClocksThrottleReasonUserDefinedClocks</span><span class="p">,</span>
            <span class="s2">&quot;clocks_throttle_reason_user_defined_clocks&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">[</span>
            <span class="n">nvmlClocksThrottleReasonApplicationsClocksSetting</span><span class="p">,</span>
            <span class="s2">&quot;clocks_throttle_reason_applications_clocks_setting&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">[</span><span class="n">nvmlClocksThrottleReasonSwPowerCap</span><span class="p">,</span> <span class="s2">&quot;clocks_throttle_reason_sw_power_cap&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="n">nvmlClocksThrottleReasonHwSlowdown</span><span class="p">,</span> <span class="s2">&quot;clocks_throttle_reason_hw_slowdown&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="n">nvmlClocksThrottleReasonUnknown</span><span class="p">,</span> <span class="s2">&quot;clocks_throttle_reason_unknown&quot;</span><span class="p">],</span>
        <span class="p">]</span>

    <span class="n">strResult</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="n">supportedClocksThrottleReasons</span> <span class="o">=</span> <span class="p">(</span>
          <span class="n">nvmlDeviceGetSupportedClocksThrottleReasons</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
      <span class="p">)</span>
      <span class="n">clocksThrottleReasons</span> <span class="o">=</span> <span class="n">nvmlDeviceGetCurrentClocksThrottleReasons</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
      <span class="n">strResult</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;clocks_throttle_reasons&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="ow">in</span> <span class="n">throttleReasons</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;clocks_throttle_reason_user_defined_clocks&quot;</span><span class="p">:</span>
          <span class="k">if</span> <span class="n">mask</span> <span class="o">&amp;</span> <span class="n">supportedClocksThrottleReasons</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="s2">&quot;Active&quot;</span> <span class="k">if</span> <span class="n">mask</span> <span class="o">&amp;</span> <span class="n">clocksThrottleReasons</span> <span class="k">else</span> <span class="s2">&quot;Not Active&quot;</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;N/A&quot;</span>  <span class="c1"># nvidia_smi.__handleError(NVML_ERROR_NOT_SUPPORTED);</span>
            <span class="p">)</span>
          <span class="n">strResult</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;</span><span class="si">%s</span><span class="s2">&gt;</span><span class="si">%s</span><span class="s2">&lt;/</span><span class="si">%s</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
      <span class="n">strResult</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/clocks_throttle_reasons&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="n">strResult</span> <span class="o">+=</span> <span class="p">(</span>
          <span class="s2">&quot;    &lt;clocks_throttle_reasons&gt;</span><span class="si">%s</span><span class="s2">&lt;/clocks_throttle_reasons&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="o">%</span> <span class="p">(</span><span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
      <span class="p">)</span>

    <span class="k">return</span> <span class="n">strResult</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">__GetClocksThrottleReasons</span><span class="p">(</span><span class="n">handle</span><span class="p">):</span>
    <span class="n">throttleReasons</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="n">nvmlClocksThrottleReasonGpuIdle</span><span class="p">,</span> <span class="s2">&quot;clocks_throttle_reason_gpu_idle&quot;</span><span class="p">],</span>
        <span class="p">[</span>
            <span class="n">nvmlClocksThrottleReasonUserDefinedClocks</span><span class="p">,</span>
            <span class="s2">&quot;clocks_throttle_reason_user_defined_clocks&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">[</span>
            <span class="n">nvmlClocksThrottleReasonApplicationsClocksSetting</span><span class="p">,</span>
            <span class="s2">&quot;clocks_throttle_reason_applications_clocks_setting&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">[</span><span class="n">nvmlClocksThrottleReasonSwPowerCap</span><span class="p">,</span> <span class="s2">&quot;clocks_throttle_reason_sw_power_cap&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="n">nvmlClocksThrottleReasonHwSlowdown</span><span class="p">,</span> <span class="s2">&quot;clocks_throttle_reason_hw_slowdown&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="n">nvmlClocksThrottleReasonUnknown</span><span class="p">,</span> <span class="s2">&quot;clocks_throttle_reason_unknown&quot;</span><span class="p">],</span>
        <span class="p">]</span>

    <span class="n">clockThrottleReasons</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="n">supportedClocksThrottleReasons</span> <span class="o">=</span> <span class="p">(</span>
          <span class="n">nvmlDeviceGetSupportedClocksThrottleReasons</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
      <span class="p">)</span>
      <span class="n">clocksThrottleReasons</span> <span class="o">=</span> <span class="n">nvmlDeviceGetCurrentClocksThrottleReasons</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="ow">in</span> <span class="n">throttleReasons</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;clocks_throttle_reason_user_defined_clocks&quot;</span><span class="p">:</span>
          <span class="k">if</span> <span class="n">mask</span> <span class="o">&amp;</span> <span class="n">supportedClocksThrottleReasons</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="s2">&quot;Active&quot;</span> <span class="k">if</span> <span class="n">mask</span> <span class="o">&amp;</span> <span class="n">clocksThrottleReasons</span> <span class="k">else</span> <span class="s2">&quot;Not Active&quot;</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;N/A&quot;</span>  <span class="c1"># nvidia_smi.__handleError(NVML_ERROR_NOT_SUPPORTED);</span>
            <span class="p">)</span>
          <span class="n">clockThrottleReasons</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
    <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="n">clockThrottleReasons</span><span class="p">[</span><span class="s2">&quot;Error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">clockThrottleReasons</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">clockThrottleReasons</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>

  <span class="c1">#</span>
  <span class="c1"># Converts errors into string messages</span>
  <span class="c1">#</span>
  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">NVML_ERROR_NOT_SUPPORTED</span><span class="p">:</span>
      <span class="k">return</span> <span class="s2">&quot;N/A&quot;</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">err</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">__toString</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

<div class="viewcode-block" id="NvidiaSMI.XmlDeviceQuery"><a class="viewcode-back" href="../../../../generated/heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.html#heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.XmlDeviceQuery">[docs]</a>  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">XmlDeviceQuery</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">filter</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Provides a Python interface to GPU management and monitoring functions.</span>

<span class="sd">    This is a wrapper around the NVML library.</span>
<span class="sd">    For information about the NVML library, see the NVML developer page</span>
<span class="sd">    http://developer.nvidia.com/nvidia-management-library-nvml</span>

<span class="sd">    Examples:</span>
<span class="sd">    ---------------------------------------------------------------------------</span>
<span class="sd">    For all elements as in XML format.  Similiar to nvisia-smi -q -x</span>

<span class="sd">    $ XmlDeviceQuery()</span>

<span class="sd">    ---------------------------------------------------------------------------</span>
<span class="sd">    For XML of filtered elements by string name.</span>
<span class="sd">    Similiar ot nvidia-smi --query-gpu=pci.bus_id,memory.total,memory.free</span>
<span class="sd">    See help_query_gpu.txt or XmlDeviceQuery(&quot;--help_query_gpu&quot;) for available filter elements</span>

<span class="sd">    $ XmlDeviceQuery(&quot;pci.bus_id,memory.total,memory.free&quot;)</span>

<span class="sd">    ---------------------------------------------------------------------------</span>
<span class="sd">    For XML of filtered elements by enumeration value.</span>
<span class="sd">    See help_query_gpu.txt or XmlDeviceQuery(&quot;--help_query_gpu&quot;) for available filter elements</span>

<span class="sd">    $ XmlDeviceQuery([NVSMI_PCI_BUS_ID, NVSMI_MEMORY_TOTAL, NVSMI_MEMORY_FREE])</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">filter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="nb">filter</span> <span class="o">=</span> <span class="p">[</span><span class="n">NVSMI_ALL</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">filter</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">filter</span> <span class="o">==</span> <span class="s2">&quot;--help&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">filter</span> <span class="o">==</span> <span class="s2">&quot;-h&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">XmlDeviceQuery</span><span class="o">.</span><span class="vm">__doc__</span>
      <span class="k">elif</span> <span class="nb">filter</span> <span class="o">==</span> <span class="s2">&quot;--help-query-gpu&quot;</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;help_query_gpu.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fin</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">fin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="nb">filter</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__fromDeviceQueryString</span><span class="p">(</span><span class="nb">filter</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="nb">filter</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">)</span>

    <span class="n">strResult</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">strResult</span> <span class="o">+=</span> <span class="s1">&#39;&lt;?xml version=&quot;1.0&quot; ?&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
      <span class="n">strResult</span> <span class="o">+=</span> <span class="s1">&#39;&lt;!DOCTYPE nvidia_smi_log SYSTEM &quot;nvsmi_device_v4.dtd&quot;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span>
      <span class="n">strResult</span> <span class="o">+=</span> <span class="s2">&quot;&lt;nvidia_smi&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

      <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_TIMESTAMP</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
        <span class="n">strResult</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="s2">&quot;  &lt;timestamp&gt;&quot;</span>
            <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span>
            <span class="o">+</span> <span class="s2">&quot;&lt;/timestamp&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
      <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_DRIVER_VERSION</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
        <span class="n">strResult</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="s2">&quot;  &lt;driver_version&gt;&quot;</span>
            <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">nvmlSystemGetDriverVersion</span><span class="p">())</span>
            <span class="o">+</span> <span class="s2">&quot;&lt;/driver_version&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>

      <span class="n">deviceCount</span> <span class="o">=</span> <span class="n">nvmlDeviceGetCount</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_COUNT</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
        <span class="n">strResult</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="s2">&quot;  &lt;count&gt;&quot;</span> <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">deviceCount</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&lt;/count&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>

      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">deviceCount</span><span class="p">):</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__handles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="n">pciInfo</span> <span class="o">=</span> <span class="n">nvmlDeviceGetPciInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>

        <span class="n">gpuInfo</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_BUS_ID</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;  &lt;id&gt;</span><span class="si">%s</span><span class="s2">&lt;/id&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pciInfo</span><span class="o">.</span><span class="n">busId</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_NAME</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;    &lt;product_name&gt;&quot;</span>
              <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">nvmlDeviceGetName</span><span class="p">(</span><span class="n">handle</span><span class="p">))</span>
              <span class="o">+</span> <span class="s2">&quot;&lt;/product_name&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>

          <span class="k">try</span><span class="p">:</span>
            <span class="c1"># if nvmlDeviceGetBrand() succeeds it is guaranteed to be in the dictionary</span>
            <span class="n">brandName</span> <span class="o">=</span> <span class="n">NVSMI_BRAND_NAMES</span><span class="p">[</span><span class="n">nvmlDeviceGetBrand</span><span class="p">(</span><span class="n">handle</span><span class="p">)]</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">brandName</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;product_brand&gt;&quot;</span> <span class="o">+</span> <span class="n">brandName</span> <span class="o">+</span> <span class="s2">&quot;&lt;/product_brand&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_DISPLAY_MODE</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;Enabled&quot;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">nvmlDeviceGetDisplayMode</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">else</span> <span class="s2">&quot;Disabled&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;display_mode&gt;&quot;</span> <span class="o">+</span> <span class="n">state</span> <span class="o">+</span> <span class="s2">&quot;&lt;/display_mode&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_DISPLAY_ACTIVE</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;Enabled&quot;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">nvmlDeviceGetDisplayActive</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">else</span> <span class="s2">&quot;Disabled&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;display_active&gt;&quot;</span> <span class="o">+</span> <span class="n">state</span> <span class="o">+</span> <span class="s2">&quot;&lt;/display_active&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PERSISTENCE_MODE</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;Enabled&quot;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">nvmlDeviceGetPersistenceMode</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">else</span> <span class="s2">&quot;Disabled&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;persistence_mode&gt;&quot;</span> <span class="o">+</span> <span class="n">mode</span> <span class="o">+</span> <span class="s2">&quot;&lt;/persistence_mode&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_ACCT_MODE</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;Enabled&quot;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">nvmlDeviceGetAccountingMode</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">else</span> <span class="s2">&quot;Disabled&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;accounting_mode&gt;&quot;</span> <span class="o">+</span> <span class="n">mode</span> <span class="o">+</span> <span class="s2">&quot;&lt;/accounting_mode&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_ACCT_BUFFER_SIZE</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">bufferSize</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                <span class="n">nvmlDeviceGetAccountingBufferSize</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">bufferSize</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;    &lt;accounting_mode_buffer_size&gt;&quot;</span>
              <span class="o">+</span> <span class="n">bufferSize</span>
              <span class="o">+</span> <span class="s2">&quot;&lt;/accounting_mode_buffer_size&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>

        <span class="n">driverModel</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">includeDriverModel</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_DRIVER_MODEL_CUR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">current</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;WDDM&quot;</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">nvmlDeviceGetCurrentDriverModel</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
                    <span class="o">==</span> <span class="n">NVML_DRIVER_WDDM</span>
                <span class="p">)</span>
                <span class="k">else</span> <span class="s2">&quot;TCC&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">driverModel</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;current_dm&gt;&quot;</span> <span class="o">+</span> <span class="n">current</span> <span class="o">+</span> <span class="s2">&quot;&lt;/current_dm&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">includeDriverModel</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_DRIVER_MODEL_PENDING</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">pending</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;WDDM&quot;</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">nvmlDeviceGetPendingDriverModel</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
                    <span class="o">==</span> <span class="n">NVML_DRIVER_WDDM</span>
                <span class="p">)</span>
                <span class="k">else</span> <span class="s2">&quot;TCC&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">pending</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">driverModel</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;      &lt;pending_dm&gt;&quot;</span> <span class="o">+</span> <span class="n">pending</span> <span class="o">+</span> <span class="s2">&quot;&lt;/pending_dm&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">includeDriverModel</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeDriverModel</span><span class="p">:</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;driver_model&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="n">driverModel</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/driver_model&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_SERIALNUMBER</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">serial</span> <span class="o">=</span> <span class="n">nvmlDeviceGetSerial</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">serial</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;    &lt;serial&gt;&quot;</span> <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">serial</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&lt;/serial&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_UUID</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">uuid</span> <span class="o">=</span> <span class="n">nvmlDeviceGetUUID</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">uuid</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;uuid&gt;&quot;</span> <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">uuid</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&lt;/uuid&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_INDEX</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">minor_number</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMinorNumber</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">minor_number</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;    &lt;minor_number&gt;&quot;</span>
              <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">minor_number</span><span class="p">)</span>
              <span class="o">+</span> <span class="s2">&quot;&lt;/minor_number&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_VBIOS_VER</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">vbios</span> <span class="o">=</span> <span class="n">nvmlDeviceGetVbiosVersion</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">vbios</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;    &lt;vbios_version&gt;&quot;</span>
              <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">vbios</span><span class="p">)</span>
              <span class="o">+</span> <span class="s2">&quot;&lt;/vbios_version&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_VBIOS_VER</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">multiGpuBool</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMultiGpuBoard</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">multiGpuBool</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="k">if</span> <span class="n">multiGpuBool</span> <span class="o">==</span> <span class="s2">&quot;N/A&quot;</span><span class="p">:</span>
            <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;    &lt;multigpu_board&gt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;N/A&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;/multigpu_board&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>
          <span class="k">elif</span> <span class="n">multiGpuBool</span><span class="p">:</span>
            <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;    &lt;multigpu_board&gt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;Yes&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;/multigpu_board&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;multigpu_board&gt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;No&quot;</span> <span class="o">+</span> <span class="s2">&quot;&lt;/multigpu_board&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_BOARD_ID</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">boardId</span> <span class="o">=</span> <span class="n">nvmlDeviceGetBoardId</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">boardId</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="k">try</span><span class="p">:</span>
            <span class="n">hexBID</span> <span class="o">=</span> <span class="s2">&quot;0x</span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">boardId</span>
          <span class="k">except</span><span class="p">:</span>
            <span class="n">hexBID</span> <span class="o">=</span> <span class="n">boardId</span>

          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;board_id&gt;&quot;</span> <span class="o">+</span> <span class="n">hexBID</span> <span class="o">+</span> <span class="s2">&quot;&lt;/board_id&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">inforomVersion</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">includeInforom</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_INFOROM_IMG</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">nvmlDeviceGetInforomImageVersion</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">inforomVersion</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;img_version&gt;&quot;</span>
              <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
              <span class="o">+</span> <span class="s2">&quot;&lt;/img_version&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includeInforom</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_INFOROM_OEM</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">oem</span> <span class="o">=</span> <span class="n">nvmlDeviceGetInforomVersion</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_INFOROM_OEM</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">oem</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">inforomVersion</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;oem_object&gt;&quot;</span>
              <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">oem</span><span class="p">)</span>
              <span class="o">+</span> <span class="s2">&quot;&lt;/oem_object&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includeInforom</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_INFOROM_ECC</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">ecc</span> <span class="o">=</span> <span class="n">nvmlDeviceGetInforomVersion</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_INFOROM_ECC</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">ecc</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">inforomVersion</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;ecc_object&gt;&quot;</span>
              <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">ecc</span><span class="p">)</span>
              <span class="o">+</span> <span class="s2">&quot;&lt;/ecc_object&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includeInforom</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_INFOROM_PWR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">pwr</span> <span class="o">=</span> <span class="n">nvmlDeviceGetInforomVersion</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_INFOROM_POWER</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">pwr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">inforomVersion</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;pwr_object&gt;&quot;</span>
              <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">pwr</span><span class="p">)</span>
              <span class="o">+</span> <span class="s2">&quot;&lt;/pwr_object&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includeInforom</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeInforom</span><span class="p">:</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;inforom_version&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="n">inforomVersion</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/inforom_version&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">gpuOperationMode</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">includeGOM</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_INFOROM_PWR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toStrGOM</span><span class="p">(</span>
                <span class="n">nvmlDeviceGetCurrentGpuOperationMode</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">gpuOperationMode</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;current_gom&gt;&quot;</span>
              <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
              <span class="o">+</span> <span class="s2">&quot;&lt;/current_gom&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includeGOM</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_INFOROM_PWR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">pending</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toStrGOM</span><span class="p">(</span>
                <span class="n">nvmlDeviceGetPendingGpuOperationMode</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">pending</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuOperationMode</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;pending_gom&gt;&quot;</span>
              <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">pending</span><span class="p">)</span>
              <span class="o">+</span> <span class="s2">&quot;&lt;/pending_gom&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includeGOM</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeGOM</span><span class="p">:</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;gpu_operation_mode&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="n">gpuOperationMode</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/gpu_operation_mode&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">pci</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">includePci</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_BUS</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">pci</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;pci_bus&gt;</span><span class="si">%02X</span><span class="s2">&lt;/pci_bus&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pciInfo</span><span class="o">.</span><span class="n">bus</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_DEVICE</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">pci</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;pci_device&gt;</span><span class="si">%02X</span><span class="s2">&lt;/pci_device&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pciInfo</span><span class="o">.</span><span class="n">device</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_DOMAIN</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">pci</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;pci_domain&gt;</span><span class="si">%04X</span><span class="s2">&lt;/pci_domain&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pciInfo</span><span class="o">.</span><span class="n">domain</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_DEVICE_ID</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">pci</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;pci_device_id&gt;</span><span class="si">%08X</span><span class="s2">&lt;/pci_device_id&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
              <span class="n">pciInfo</span><span class="o">.</span><span class="n">pciDeviceId</span>
          <span class="p">)</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_BUS_ID</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">pci</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;pci_bus_id&gt;&quot;</span>
              <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">pciInfo</span><span class="o">.</span><span class="n">busId</span><span class="p">)</span>
              <span class="o">+</span> <span class="s2">&quot;&lt;/pci_bus_id&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_SUBDEVICE_ID</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">pci</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;pci_sub_system_id&gt;</span><span class="si">%08X</span><span class="s2">&lt;/pci_sub_system_id&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
              <span class="n">pciInfo</span><span class="o">.</span><span class="n">pciSubSystemId</span>
          <span class="p">)</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">pciGpuLinkInfo</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">includeLinkInfo</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">pciGen</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">includeGen</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_LINK_GEN_MAX</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">gen</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                <span class="n">nvmlDeviceGetMaxPcieLinkGeneration</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">gen</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">pciGen</span> <span class="o">+=</span> <span class="s2">&quot;          &lt;max_link_gen&gt;&quot;</span> <span class="o">+</span> <span class="n">gen</span> <span class="o">+</span> <span class="s2">&quot;&lt;/max_link_gen&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">includeGen</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_LINK_GEN_CUR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">gen</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                <span class="n">nvmlDeviceGetCurrPcieLinkGeneration</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">gen</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">pciGen</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;          &lt;current_link_gen&gt;&quot;</span> <span class="o">+</span> <span class="n">gen</span> <span class="o">+</span> <span class="s2">&quot;&lt;/current_link_gen&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includeGen</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeGen</span><span class="p">:</span>
          <span class="n">pciGpuLinkInfo</span> <span class="o">+=</span> <span class="s2">&quot;        &lt;pcie_gen&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">pciGpuLinkInfo</span> <span class="o">+=</span> <span class="n">pciGen</span>
          <span class="n">pciGpuLinkInfo</span> <span class="o">+=</span> <span class="s2">&quot;        &lt;/pcie_gen&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">includeLinkInfo</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">pciLinkWidths</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">includeLinkWidths</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_LINK_WIDTH_MAX</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">nvmlDeviceGetMaxPcieLinkWidth</span><span class="p">(</span><span class="n">handle</span><span class="p">))</span>
                <span class="o">+</span> <span class="s2">&quot;x&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">pciLinkWidths</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;          &lt;max_link_width&gt;&quot;</span> <span class="o">+</span> <span class="n">width</span> <span class="o">+</span> <span class="s2">&quot;&lt;/max_link_width&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includeLinkWidths</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_LINK_WIDTH_CUR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">nvmlDeviceGetCurrPcieLinkWidth</span><span class="p">(</span><span class="n">handle</span><span class="p">))</span>
                <span class="o">+</span> <span class="s2">&quot;x&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">pciLinkWidths</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;          &lt;current_link_width&gt;&quot;</span>
              <span class="o">+</span> <span class="n">width</span>
              <span class="o">+</span> <span class="s2">&quot;&lt;/current_link_width&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includeLinkWidths</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeLinkWidths</span><span class="p">:</span>
          <span class="n">pciGpuLinkInfo</span> <span class="o">+=</span> <span class="s2">&quot;        &lt;link_widths&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">pciGpuLinkInfo</span> <span class="o">+=</span> <span class="n">pciLinkWidths</span>
          <span class="n">pciGpuLinkInfo</span> <span class="o">+=</span> <span class="s2">&quot;        &lt;/link_widths&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">includeLinkInfo</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeLinkInfo</span><span class="p">:</span>
          <span class="n">pci</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;pci_gpu_link_info&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">pci</span> <span class="o">+=</span> <span class="n">pciGpuLinkInfo</span>
          <span class="n">pci</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;/pci_gpu_link_info&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">pciBridgeChip</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">includeBridgeChip</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">bridgeHierarchy</span> <span class="o">=</span> <span class="n">nvmlDeviceGetBridgeChipInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">bridge_type</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">bridgeHierarchy</span><span class="o">.</span><span class="n">bridgeChipInfo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
              <span class="n">bridge_type</span> <span class="o">+=</span> <span class="s2">&quot;PLX&quot;</span>
            <span class="k">else</span><span class="p">:</span>
              <span class="n">bridge_type</span> <span class="o">+=</span> <span class="s2">&quot;BR04&quot;</span>
            <span class="n">pciBridgeChip</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;        &lt;bridge_chip_type&gt;&quot;</span>
                <span class="o">+</span> <span class="n">bridge_type</span>
                <span class="o">+</span> <span class="s2">&quot;&lt;/bridge_chip_type&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">bridgeHierarchy</span><span class="o">.</span><span class="n">bridgeChipInfo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fwVersion</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
              <span class="n">strFwVersion</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
            <span class="k">else</span><span class="p">:</span>
              <span class="n">strFwVersion</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%08X</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                  <span class="n">bridgeHierarchy</span><span class="o">.</span><span class="n">bridgeChipInfo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fwVersion</span>
              <span class="p">)</span>
            <span class="n">pciBridgeChip</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;        &lt;bridge_chip_fw&gt;</span><span class="si">%s</span><span class="s2">&lt;/bridge_chip_fw&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="o">%</span> <span class="n">strFwVersion</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">pciBridgeChip</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;        &lt;bridge_chip_type&gt;&quot;</span>
                <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;&lt;/bridge_chip_type&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">pciBridgeChip</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;        &lt;bridge_chip_fw&gt;&quot;</span>
                <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;&lt;/bridge_chip_fw&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>
          <span class="n">includeBridgeChip</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeBridgeChip</span><span class="p">:</span>
          <span class="c1"># Add additional code for hierarchy of bridges for Bug # 1382323</span>
          <span class="n">pci</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;pci_bridge_chip&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">pci</span> <span class="o">+=</span> <span class="n">pciBridgeChip</span>
          <span class="n">pci</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;/pci_bridge_chip&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">replay</span> <span class="o">=</span> <span class="n">nvmlDeviceGetPcieReplayCounter</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">pci</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;      &lt;replay_counter&gt;&quot;</span>
                <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">replay</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;&lt;/replay_counter&gt;&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">pci</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;      &lt;replay_counter&gt;&quot;</span>
                <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;&lt;/replay_counter&gt;&quot;</span>
            <span class="p">)</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">tx_bytes</span> <span class="o">=</span> <span class="n">nvmlDeviceGetPcieThroughput</span><span class="p">(</span>
                <span class="n">handle</span><span class="p">,</span> <span class="n">NVML_PCIE_UTIL_TX_BYTES</span>
                <span class="p">)</span>
            <span class="n">pci</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;      &lt;tx_util&gt;&quot;</span>
                <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">tx_bytes</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; KB/s&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;&lt;/tx_util&gt;&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">pci</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;      &lt;tx_util&gt;&quot;</span>
                <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;&lt;/tx_util&gt;&quot;</span>
            <span class="p">)</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">rx_bytes</span> <span class="o">=</span> <span class="n">nvmlDeviceGetPcieThroughput</span><span class="p">(</span>
                <span class="n">handle</span><span class="p">,</span> <span class="n">NVML_PCIE_UTIL_RX_BYTES</span>
                <span class="p">)</span>
            <span class="n">pci</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;      &lt;rx_util&gt;&quot;</span>
                <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">rx_bytes</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; KB/s&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;&lt;/rx_util&gt;&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">pci</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;      &lt;rx_util&gt;&quot;</span>
                <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;&lt;/rx_util&gt;&quot;</span>
            <span class="p">)</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includePci</span><span class="p">:</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;pci&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="n">pci</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/pci&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_FAN_SPEED</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">fan</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">nvmlDeviceGetFanSpeed</span><span class="p">(</span><span class="n">handle</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; %&quot;</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">fan</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;fan_speed&gt;&quot;</span> <span class="o">+</span> <span class="n">fan</span> <span class="o">+</span> <span class="s2">&quot;&lt;/fan_speed&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PSTATE</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">perfState</span> <span class="o">=</span> <span class="n">nvmlDeviceGetPowerState</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">perfStateStr</span> <span class="o">=</span> <span class="s2">&quot;P</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">perfState</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">perfStateStr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;    &lt;performance_state&gt;&quot;</span>
              <span class="o">+</span> <span class="n">perfStateStr</span>
              <span class="o">+</span> <span class="s2">&quot;&lt;/performance_state&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_SUPPORTED</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_ACTIVE</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_IDLE</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_APP_SETTING</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_SW_PWR_CAP</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_HW_SLOWDOWN</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_HW_THERMAL_SLOWDOWN</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_HW_PWR_BRAKE_SLOWDOWN</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_SW_THERMAL_SLOWDOWN</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_SYNC_BOOST</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="p">):</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__xmlGetClocksThrottleReasons</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>

        <span class="n">fbMemoryUsage</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">includeMemoryUsage</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_MEMORY_TOTAL</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_MEMORY_USED</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_MEMORY_FREE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="p">):</span>

          <span class="n">includeMemoryUsage</span> <span class="o">=</span> <span class="kc">True</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">memInfo</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMemoryInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">mem_total</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">memInfo</span><span class="o">.</span><span class="n">total</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; MiB&quot;</span>
            <span class="p">)</span>
            <span class="n">mem_used</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">memInfo</span><span class="o">.</span><span class="n">used</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; MiB&quot;</span>
            <span class="p">)</span>
            <span class="n">mem_free</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                    <span class="n">memInfo</span><span class="o">.</span><span class="n">total</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">-</span> <span class="n">memInfo</span><span class="o">.</span><span class="n">used</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
                    <span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; MiB&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">mem_total</span> <span class="o">=</span> <span class="n">error</span>
            <span class="n">mem_used</span> <span class="o">=</span> <span class="n">error</span>
            <span class="n">mem_free</span> <span class="o">=</span> <span class="n">error</span>

          <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_MEMORY_TOTAL</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
            <span class="n">fbMemoryUsage</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;total&gt;&quot;</span> <span class="o">+</span> <span class="n">mem_total</span> <span class="o">+</span> <span class="s2">&quot;&lt;/total&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_MEMORY_USED</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
            <span class="n">fbMemoryUsage</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;used&gt;&quot;</span> <span class="o">+</span> <span class="n">mem_used</span> <span class="o">+</span> <span class="s2">&quot;&lt;/used&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_MEMORY_FREE</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
            <span class="n">fbMemoryUsage</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;free&gt;&quot;</span> <span class="o">+</span> <span class="n">mem_free</span> <span class="o">+</span> <span class="s2">&quot;&lt;/free&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">includeMemoryUsage</span><span class="p">:</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;fb_memory_usage&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="n">fbMemoryUsage</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/fb_memory_usage&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_MEMORY_BAR1</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">memInfo</span> <span class="o">=</span> <span class="n">nvmlDeviceGetBAR1MemoryInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">mem_total</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">memInfo</span><span class="o">.</span><span class="n">bar1Total</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; MiB&quot;</span>
            <span class="p">)</span>
            <span class="n">mem_used</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">memInfo</span><span class="o">.</span><span class="n">bar1Used</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; MiB&quot;</span>
            <span class="p">)</span>
            <span class="n">mem_free</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                    <span class="n">memInfo</span><span class="o">.</span><span class="n">bar1Total</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
                    <span class="o">-</span> <span class="n">memInfo</span><span class="o">.</span><span class="n">bar1Used</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
                    <span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; MiB&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">mem_total</span> <span class="o">=</span> <span class="n">error</span>
            <span class="n">mem_used</span> <span class="o">=</span> <span class="n">error</span>
            <span class="n">mem_free</span> <span class="o">=</span> <span class="n">error</span>

          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;bar1_memory_usage&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;total&gt;&quot;</span> <span class="o">+</span> <span class="n">mem_total</span> <span class="o">+</span> <span class="s2">&quot;&lt;/total&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;used&gt;&quot;</span> <span class="o">+</span> <span class="n">mem_used</span> <span class="o">+</span> <span class="s2">&quot;&lt;/used&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;free&gt;&quot;</span> <span class="o">+</span> <span class="n">mem_free</span> <span class="o">+</span> <span class="s2">&quot;&lt;/free&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/bar1_memory_usage&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_COMPUTE_MODE</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="n">nvmlDeviceGetComputeMode</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">NVML_COMPUTEMODE_DEFAULT</span><span class="p">:</span>
              <span class="n">modeStr</span> <span class="o">=</span> <span class="s2">&quot;Default&quot;</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">NVML_COMPUTEMODE_EXCLUSIVE_THREAD</span><span class="p">:</span>
              <span class="n">modeStr</span> <span class="o">=</span> <span class="s2">&quot;Exclusive Thread&quot;</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">NVML_COMPUTEMODE_PROHIBITED</span><span class="p">:</span>
              <span class="n">modeStr</span> <span class="o">=</span> <span class="s2">&quot;Prohibited&quot;</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">NVML_COMPUTEMODE_EXCLUSIVE_PROCESS</span><span class="p">:</span>
              <span class="n">modeStr</span> <span class="o">=</span> <span class="s2">&quot;Exclusive_Process&quot;</span>
            <span class="k">else</span><span class="p">:</span>
              <span class="n">modeStr</span> <span class="o">=</span> <span class="s2">&quot;Unknown&quot;</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">modeStr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;compute_mode&gt;&quot;</span> <span class="o">+</span> <span class="n">modeStr</span> <span class="o">+</span> <span class="s2">&quot;&lt;/compute_mode&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">utilization</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">includeUtilization</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_UTILIZATION_GPU</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_UTILIZATION_MEM</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="p">):</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">util</span> <span class="o">=</span> <span class="n">nvmlDeviceGetUtilizationRates</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">gpu_util</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">gpu</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; %&quot;</span>
            <span class="n">mem_util</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">memory</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; %&quot;</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">gpu_util</span> <span class="o">=</span> <span class="n">error</span>
            <span class="n">mem_util</span> <span class="o">=</span> <span class="n">error</span>

          <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_UTILIZATION_GPU</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
            <span class="n">utilization</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;gpu_util&gt;&quot;</span> <span class="o">+</span> <span class="n">gpu_util</span> <span class="o">+</span> <span class="s2">&quot;&lt;/gpu_util&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

          <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_UTILIZATION_MEM</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
            <span class="n">utilization</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;      &lt;memory_util&gt;&quot;</span> <span class="o">+</span> <span class="n">mem_util</span> <span class="o">+</span> <span class="s2">&quot;&lt;/memory_util&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>

          <span class="n">includeUtilization</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_UTILIZATION_ENCODER</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="p">(</span><span class="n">util_int</span><span class="p">,</span> <span class="n">ssize</span><span class="p">)</span> <span class="o">=</span> <span class="n">nvmlDeviceGetEncoderUtilization</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">encoder_util</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">util_int</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; %&quot;</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">encoder_util</span> <span class="o">=</span> <span class="n">error</span>

          <span class="n">utilization</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;encoder_util&gt;&quot;</span> <span class="o">+</span> <span class="n">encoder_util</span> <span class="o">+</span> <span class="s2">&quot;&lt;/encoder_util&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>

          <span class="n">includeUtilization</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_UTILIZATION_DECODER</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="p">(</span><span class="n">util_int</span><span class="p">,</span> <span class="n">ssize</span><span class="p">)</span> <span class="o">=</span> <span class="n">nvmlDeviceGetDecoderUtilization</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">decoder_util</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">util_int</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; %&quot;</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">decoder_util</span> <span class="o">=</span> <span class="n">error</span>

          <span class="n">utilization</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;decoder_util&gt;&quot;</span> <span class="o">+</span> <span class="n">decoder_util</span> <span class="o">+</span> <span class="s2">&quot;&lt;/decoder_util&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>

          <span class="n">includeUtilization</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeUtilization</span><span class="p">:</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;utilization&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="n">utilization</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/utilization&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_ECC_MODE_CUR</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_ECC_MODE_PENDING</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="p">):</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">pending</span><span class="p">)</span> <span class="o">=</span> <span class="n">nvmlDeviceGetEccMode</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">curr_str</span> <span class="o">=</span> <span class="s2">&quot;Enabled&quot;</span> <span class="k">if</span> <span class="p">(</span><span class="n">current</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;Disabled&quot;</span>
            <span class="n">pend_str</span> <span class="o">=</span> <span class="s2">&quot;Enabled&quot;</span> <span class="k">if</span> <span class="p">(</span><span class="n">pending</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;Disabled&quot;</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">curr_str</span> <span class="o">=</span> <span class="n">error</span>
            <span class="n">pend_str</span> <span class="o">=</span> <span class="n">error</span>

          <span class="n">eccMode</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
          <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_ECC_MODE_CUR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
            <span class="n">eccMode</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;current_ecc&gt;&quot;</span> <span class="o">+</span> <span class="n">curr_str</span> <span class="o">+</span> <span class="s2">&quot;&lt;/current_ecc&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_ECC_MODE_PENDING</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
            <span class="n">eccMode</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;pending_ecc&gt;&quot;</span> <span class="o">+</span> <span class="n">pend_str</span> <span class="o">+</span> <span class="s2">&quot;&lt;/pending_ecc&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;ecc_mode&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="n">eccMode</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/ecc_mode&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">eccErrors</span><span class="p">,</span> <span class="n">includeEccErrors</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__xmlGetEcc</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">filter</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">includeEccErrors</span><span class="p">:</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;ecc_errors&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="n">eccErrors</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/ecc_errors&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">retiredPages</span><span class="p">,</span> <span class="n">includeRetiredPages</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__xmlGetRetiredPages</span><span class="p">(</span>
            <span class="n">handle</span><span class="p">,</span> <span class="nb">filter</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">includeRetiredPages</span><span class="p">:</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;retired_pages&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="n">retiredPages</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/retired_pages&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">temperature</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">includeTemperature</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_TEMPERATURE_GPU</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                    <span class="n">nvmlDeviceGetTemperature</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_TEMPERATURE_GPU</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; C&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">temperature</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;gpu_temp&gt;&quot;</span> <span class="o">+</span> <span class="n">temp</span> <span class="o">+</span> <span class="s2">&quot;&lt;/gpu_temp&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

          <span class="k">try</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                    <span class="n">nvmlDeviceGetTemperatureThreshold</span><span class="p">(</span>
                        <span class="n">handle</span><span class="p">,</span> <span class="n">NVML_TEMPERATURE_THRESHOLD_SHUTDOWN</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; C&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">temperature</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;gpu_temp_max_threshold&gt;&quot;</span>
              <span class="o">+</span> <span class="n">temp</span>
              <span class="o">+</span> <span class="s2">&quot;&lt;/gpu_temp_max_threshold&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includeTemperature</span> <span class="o">=</span> <span class="kc">True</span>

          <span class="k">try</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                    <span class="n">nvmlDeviceGetTemperatureThreshold</span><span class="p">(</span>
                        <span class="n">handle</span><span class="p">,</span> <span class="n">NVML_TEMPERATURE_THRESHOLD_SLOWDOWN</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; C&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">temperature</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;gpu_temp_slow_threshold&gt;&quot;</span>
              <span class="o">+</span> <span class="n">temp</span>
              <span class="o">+</span> <span class="s2">&quot;&lt;/gpu_temp_slow_threshold&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includeTemperature</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeTemperature</span><span class="p">:</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;temperature&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+</span> <span class="n">temperature</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/temperature&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">power_readings</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">includePowerReadings</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_POWER_MGMT</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">powMan</span> <span class="o">=</span> <span class="n">nvmlDeviceGetPowerManagementMode</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">powManStr</span> <span class="o">=</span> <span class="s2">&quot;Supported&quot;</span> <span class="k">if</span> <span class="n">powMan</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;N/A&quot;</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">powManStr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">power_readings</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;power_management&gt;&quot;</span> <span class="o">+</span> <span class="n">powManStr</span> <span class="o">+</span> <span class="s2">&quot;&lt;/power_management&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includePowerReadings</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_POWER_DRAW</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">powDraw</span> <span class="o">=</span> <span class="n">nvmlDeviceGetPowerUsage</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span>
            <span class="n">powDrawStr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2"> W&quot;</span> <span class="o">%</span> <span class="n">powDraw</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">powDrawStr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">power_readings</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;power_draw&gt;&quot;</span> <span class="o">+</span> <span class="n">powDrawStr</span> <span class="o">+</span> <span class="s2">&quot;&lt;/power_draw&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includePowerReadings</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_POWER_LIMIT</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">powLimit</span> <span class="o">=</span> <span class="n">nvmlDeviceGetPowerManagementLimit</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span>
            <span class="n">powLimitStr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2"> W&quot;</span> <span class="o">%</span> <span class="n">powLimit</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">powLimitStr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">power_readings</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;power_limit&gt;&quot;</span> <span class="o">+</span> <span class="n">powLimitStr</span> <span class="o">+</span> <span class="s2">&quot;&lt;/power_limit&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includePowerReadings</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_POWER_LIMIT_DEFAULT</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">powLimit</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">nvmlDeviceGetPowerManagementDefaultLimit</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span>
            <span class="p">)</span>
            <span class="n">powLimitStr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2"> W&quot;</span> <span class="o">%</span> <span class="n">powLimit</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">powLimitStr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">power_readings</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;default_power_limit&gt;&quot;</span>
              <span class="o">+</span> <span class="n">powLimitStr</span>
              <span class="o">+</span> <span class="s2">&quot;&lt;/default_power_limit&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includePowerReadings</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_POWER_LIMIT_ENFORCED</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">enforcedPowLimit</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">nvmlDeviceGetEnforcedPowerLimit</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span>
            <span class="p">)</span>
            <span class="n">enforcedPowLimitStr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2"> W&quot;</span> <span class="o">%</span> <span class="n">enforcedPowLimit</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">enforcedPowLimitStr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">power_readings</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;enforced_power_limit&gt;&quot;</span>
              <span class="o">+</span> <span class="n">enforcedPowLimitStr</span>
              <span class="o">+</span> <span class="s2">&quot;&lt;/enforced_power_limit&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includePowerReadings</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_POWER_LIMIT_MIN</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_POWER_LIMIT_MAX</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="p">):</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">powLimit</span> <span class="o">=</span> <span class="n">nvmlDeviceGetPowerManagementLimitConstraints</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">powLimitStrMin</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2"> W&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">powLimit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">)</span>
            <span class="n">powLimitStrMax</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2"> W&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">powLimit</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">powLimitStrMin</span> <span class="o">=</span> <span class="n">error</span>
            <span class="n">powLimitStrMax</span> <span class="o">=</span> <span class="n">error</span>
          <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_POWER_LIMIT_MIN</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
            <span class="n">power_readings</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;      &lt;min_power_limit&gt;&quot;</span>
                <span class="o">+</span> <span class="n">powLimitStrMin</span>
                <span class="o">+</span> <span class="s2">&quot;&lt;/min_power_limit&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>
          <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_POWER_LIMIT_MAX</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
            <span class="n">power_readings</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;      &lt;max_power_limit&gt;&quot;</span>
                <span class="o">+</span> <span class="n">powLimitStrMax</span>
                <span class="o">+</span> <span class="s2">&quot;&lt;/max_power_limit&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>
          <span class="n">includePowerReadings</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includePowerReadings</span><span class="p">:</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;power_readings&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">perfState</span> <span class="o">=</span> <span class="s2">&quot;P&quot;</span> <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                <span class="n">nvmlDeviceGetPowerState</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">perfState</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;power_state&gt;</span><span class="si">%s</span><span class="s2">&lt;/power_state&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">perfState</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="n">power_readings</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/power_readings&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">clocks</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">includeClocks</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_GRAPHICS_CUR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">graphics</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                    <span class="n">nvmlDeviceGetClockInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_GRAPHICS</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; MHz&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">graphics</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">clocks</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;graphics_clock&gt;&quot;</span> <span class="o">+</span> <span class="n">graphics</span> <span class="o">+</span> <span class="s2">&quot;&lt;/graphics_clock&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includeClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_GRAPHICS_CUR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">sm</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                    <span class="n">nvmlDeviceGetClockInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_SM</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; MHz&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">sm</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">clocks</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;sm_clock&gt;&quot;</span> <span class="o">+</span> <span class="n">sm</span> <span class="o">+</span> <span class="s2">&quot;&lt;/sm_clock&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">includeClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_MEMORY_CUR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                    <span class="n">nvmlDeviceGetClockInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_MEM</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; MHz&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">clocks</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;mem_clock&gt;&quot;</span> <span class="o">+</span> <span class="n">mem</span> <span class="o">+</span> <span class="s2">&quot;&lt;/mem_clock&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">includeClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeClocks</span><span class="p">:</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;clocks&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="n">clocks</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/clocks&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">applicationClocks</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">includeAppClocks</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_APPL_GRAPHICS</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">graphics</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                    <span class="n">nvmlDeviceGetApplicationsClock</span><span class="p">(</span>
                        <span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_GRAPHICS</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; MHz&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">graphics</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">applicationClocks</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;graphics_clock&gt;&quot;</span> <span class="o">+</span> <span class="n">graphics</span> <span class="o">+</span> <span class="s2">&quot;&lt;/graphics_clock&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includeAppClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_APPL_MEMORY</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                    <span class="n">nvmlDeviceGetApplicationsClock</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_MEM</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; MHz&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">applicationClocks</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;mem_clock&gt;&quot;</span> <span class="o">+</span> <span class="n">mem</span> <span class="o">+</span> <span class="s2">&quot;&lt;/mem_clock&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">includeAppClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeAppClocks</span><span class="p">:</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;applications_clocks&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="n">applicationClocks</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/applications_clocks&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">defaultApplicationClocks</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">includeDefaultAppClocks</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_APPL_GRAPHICS_DEFAULT</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">graphics</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                    <span class="n">nvmlDeviceGetDefaultApplicationsClock</span><span class="p">(</span>
                        <span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_GRAPHICS</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; MHz&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">graphics</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">defaultApplicationClocks</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;graphics_clock&gt;&quot;</span> <span class="o">+</span> <span class="n">graphics</span> <span class="o">+</span> <span class="s2">&quot;&lt;/graphics_clock&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includeDefaultAppClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_APPL_MEMORY_DEFAULT</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                    <span class="n">nvmlDeviceGetDefaultApplicationsClock</span><span class="p">(</span>
                        <span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_MEM</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; MHz&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">defaultApplicationClocks</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;mem_clock&gt;&quot;</span> <span class="o">+</span> <span class="n">mem</span> <span class="o">+</span> <span class="s2">&quot;&lt;/mem_clock&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includeDefaultAppClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeDefaultAppClocks</span><span class="p">:</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;default_applications_clocks&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="n">defaultApplicationClocks</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/default_applications_clocks&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">maxClocks</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">includeMaxClocks</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_GRAPHICS_MAX</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">graphics</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                    <span class="n">nvmlDeviceGetMaxClockInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_GRAPHICS</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; MHz&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">graphics</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">maxClocks</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;graphics_clock&gt;&quot;</span> <span class="o">+</span> <span class="n">graphics</span> <span class="o">+</span> <span class="s2">&quot;&lt;/graphics_clock&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">includeMaxClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_SM_MAX</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">sm</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                    <span class="n">nvmlDeviceGetMaxClockInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_SM</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; MHz&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">sm</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">maxClocks</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;sm_clock&gt;&quot;</span> <span class="o">+</span> <span class="n">sm</span> <span class="o">+</span> <span class="s2">&quot;&lt;/sm_clock&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">includeMaxClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_MEMORY_MAX</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                    <span class="n">nvmlDeviceGetMaxClockInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_MEM</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; MHz&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">maxClocks</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;mem_clock&gt;&quot;</span> <span class="o">+</span> <span class="n">mem</span> <span class="o">+</span> <span class="s2">&quot;&lt;/mem_clock&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">includeMaxClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeMaxClocks</span><span class="p">:</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;max_clocks&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="n">maxClocks</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/max_clocks&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_POLICY</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;clock_policy&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="p">(</span>
                <span class="n">boostedState</span><span class="p">,</span>
                <span class="n">boostedDefaultState</span><span class="p">,</span>
                <span class="p">)</span> <span class="o">=</span> <span class="n">nvmlDeviceGetAutoBoostedClocksEnabled</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">boostedState</span> <span class="o">==</span> <span class="n">NVML_FEATURE_DISABLED</span><span class="p">:</span>
              <span class="n">autoBoostStr</span> <span class="o">=</span> <span class="s2">&quot;Off&quot;</span>
            <span class="k">else</span><span class="p">:</span>
              <span class="n">autoBoostStr</span> <span class="o">=</span> <span class="s2">&quot;On&quot;</span>

            <span class="k">if</span> <span class="n">boostedDefaultState</span> <span class="o">==</span> <span class="n">NVML_FEATURE_DISABLED</span><span class="p">:</span>
              <span class="n">autoBoostDefaultStr</span> <span class="o">=</span> <span class="s2">&quot;Off&quot;</span>
            <span class="k">else</span><span class="p">:</span>
              <span class="n">autoBoostDefaultStr</span> <span class="o">=</span> <span class="s2">&quot;On&quot;</span>

          <span class="k">except</span> <span class="n">NVMLError_NotSupported</span><span class="p">:</span>
            <span class="n">autoBoostStr</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
            <span class="n">autoBoostDefaultStr</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">autoBoostStr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">autoBoostDefaultStr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="k">pass</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;auto_boost&gt;&quot;</span> <span class="o">+</span> <span class="n">autoBoostStr</span> <span class="o">+</span> <span class="s2">&quot;&lt;/auto_boost&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
              <span class="s2">&quot;      &lt;auto_boost_default&gt;&quot;</span>
              <span class="o">+</span> <span class="n">autoBoostDefaultStr</span>
              <span class="o">+</span> <span class="s2">&quot;&lt;/auto_boost_default&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="p">)</span>
          <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/clock_policy&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_SUPPORTED</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">memClocks</span> <span class="o">=</span> <span class="n">nvmlDeviceGetSupportedMemoryClocks</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;supported_clocks&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">memClocks</span><span class="p">:</span>
              <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;supported_mem_clock&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;        &lt;value&gt;</span><span class="si">%d</span><span class="s2"> MHz&lt;/value&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">m</span>
              <span class="k">try</span><span class="p">:</span>
                <span class="n">clocks</span> <span class="o">=</span> <span class="n">nvmlDeviceGetSupportedGraphicsClocks</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">clocks</span><span class="p">:</span>
                  <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
                      <span class="s2">&quot;        &lt;supported_graphics_clock&gt;</span><span class="si">%d</span><span class="s2"> MHz&lt;/supported_graphics_clock&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
                      <span class="o">%</span> <span class="n">c</span>
                  <span class="p">)</span>
              <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
                    <span class="s2">&quot;        &lt;supported_graphics_clock&gt;</span><span class="si">%s</span><span class="s2">&lt;/supported_graphics_clock&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="o">%</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
                <span class="p">)</span>
              <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;/supported_mem_clock&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

            <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/supported_clocks&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;    &lt;supported_clocks&gt;&quot;</span>
                <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;&lt;/supported_clocks&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_COMPUTE_APPS</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">procs</span> <span class="o">=</span> <span class="n">nvmlDeviceGetComputeRunningProcesses</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;processes&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">procs</span><span class="p">:</span>
              <span class="k">try</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                    <span class="n">nvmlSystemGetProcessName</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">pid</span><span class="p">)</span>
                    <span class="p">)</span>
              <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">NVML_ERROR_NOT_FOUND</span><span class="p">:</span>
                  <span class="c1"># probably went away</span>
                  <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                  <span class="n">name</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

              <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;process_info&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;pid&gt;</span><span class="si">%d</span><span class="s2">&lt;/pid&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">p</span><span class="o">.</span><span class="n">pid</span>
              <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
                  <span class="s2">&quot;      &lt;process_name&gt;&quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;&lt;/process_name&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="p">)</span>

              <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">usedGpuMemory</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">mem</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
              <span class="k">else</span><span class="p">:</span>
                <span class="n">mem</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> MiB&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">usedGpuMemory</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">)</span>
              <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;used_memory&gt;&quot;</span> <span class="o">+</span> <span class="n">mem</span> <span class="o">+</span> <span class="s2">&quot;&lt;/used_memory&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/process_info&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

            <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/processes&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;    &lt;processes&gt;&quot;</span>
                <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;&lt;/processes&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_ACCOUNTED_APPS</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">pids</span> <span class="o">=</span> <span class="n">nvmlDeviceGetAccountingPids</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;accounted_processes&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

            <span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">pids</span><span class="p">:</span>
              <span class="k">try</span><span class="p">:</span>
                <span class="n">stats</span> <span class="o">=</span> <span class="n">nvmlDeviceGetAccountingStats</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>
                <span class="n">gpuUtilization</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> </span><span class="si">%%</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stats</span><span class="o">.</span><span class="n">gpuUtilization</span>
                <span class="n">memoryUtilization</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> </span><span class="si">%%</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stats</span><span class="o">.</span><span class="n">memoryUtilization</span>
                <span class="k">if</span> <span class="n">stats</span><span class="o">.</span><span class="n">maxMemoryUsage</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                  <span class="n">maxMemoryUsage</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                  <span class="n">maxMemoryUsage</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> MiB&quot;</span> <span class="o">%</span> <span class="p">(</span>
                      <span class="n">stats</span><span class="o">.</span><span class="n">maxMemoryUsage</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
                  <span class="p">)</span>
                <span class="n">time</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> ms&quot;</span> <span class="o">%</span> <span class="n">stats</span><span class="o">.</span><span class="n">time</span>
                <span class="n">is_running</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stats</span><span class="o">.</span><span class="n">isRunning</span>
              <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">NVML_ERROR_NOT_FOUND</span><span class="p">:</span>
                  <span class="c1"># probably went away</span>
                  <span class="k">continue</span>
                <span class="n">err</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
                <span class="n">gpuUtilization</span> <span class="o">=</span> <span class="n">err</span>
                <span class="n">memoryUtilization</span> <span class="o">=</span> <span class="n">err</span>
                <span class="n">maxMemoryUsage</span> <span class="o">=</span> <span class="n">err</span>
                <span class="n">time</span> <span class="o">=</span> <span class="n">err</span>
                <span class="n">is_running</span> <span class="o">=</span> <span class="n">err</span>

              <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;accounted_process_info&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;pid&gt;</span><span class="si">%d</span><span class="s2">&lt;/pid&gt;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pid</span>
              <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
                  <span class="s2">&quot;      &lt;gpu_util&gt;&quot;</span> <span class="o">+</span> <span class="n">gpuUtilization</span> <span class="o">+</span> <span class="s2">&quot;&lt;/gpu_util&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="p">)</span>
              <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
                  <span class="s2">&quot;      &lt;memory_util&gt;&quot;</span>
                  <span class="o">+</span> <span class="n">memoryUtilization</span>
                  <span class="o">+</span> <span class="s2">&quot;&lt;/memory_util&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="p">)</span>
              <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
                  <span class="s2">&quot;      &lt;max_memory_usage&gt;&quot;</span>
                  <span class="o">+</span> <span class="n">maxMemoryUsage</span>
                  <span class="o">+</span> <span class="s2">&quot;&lt;/max_memory_usage&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="p">)</span>
              <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;      &lt;time&gt;&quot;</span> <span class="o">+</span> <span class="n">time</span> <span class="o">+</span> <span class="s2">&quot;&lt;/time&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
                  <span class="s2">&quot;      &lt;is_running&gt;&quot;</span> <span class="o">+</span> <span class="n">is_running</span> <span class="o">+</span> <span class="s2">&quot;&lt;/is_running&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="p">)</span>
              <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/accounted_process_info&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

            <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="s2">&quot;    &lt;/accounted_processes&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">gpuInfo</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;    &lt;accounted_processes&gt;&quot;</span>
                <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;&lt;/accounted_processes&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gpuInfo</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">strResult</span> <span class="o">+=</span> <span class="s2">&quot;  &lt;gpu&gt;&quot;</span>
          <span class="n">strResult</span> <span class="o">+=</span> <span class="n">gpuInfo</span>
          <span class="n">strResult</span> <span class="o">+=</span> <span class="s2">&quot;  &lt;/gpu&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

      <span class="n">strResult</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/nvidia_smi&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="n">strResult</span> <span class="o">+=</span> <span class="s2">&quot;nvidia_smi.py: &quot;</span> <span class="o">+</span> <span class="n">err</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">strResult</span></div>

<div class="viewcode-block" id="NvidiaSMI.DeviceQuery"><a class="viewcode-back" href="../../../../generated/heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.html#heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.DeviceQuery">[docs]</a>  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">DeviceQuery</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">filter</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Provides a Python interface to GPU management and monitoring functions.</span>

<span class="sd">    This is a wrapper around the NVML library.</span>
<span class="sd">    For information about the NVML library, see the NVML developer page</span>
<span class="sd">    http://developer.nvidia.com/nvidia-management-library-nvml</span>

<span class="sd">    Examples:</span>
<span class="sd">    ---------------------------------------------------------------------------</span>
<span class="sd">    For all elements as a list of dictionaries.  Similiar to nvisia-smi -q -x</span>

<span class="sd">    $ DeviceQuery()</span>

<span class="sd">    ---------------------------------------------------------------------------</span>
<span class="sd">    For a list of filtered dictionary elements by string name.</span>
<span class="sd">    Similiar ot nvidia-smi --query-gpu=pci.bus_id,memory.total,memory.free</span>
<span class="sd">    See help_query_gpu.txt or DeviceQuery(&quot;--help_query_gpu&quot;) for available filter elements</span>

<span class="sd">    $ DeviceQuery(&quot;pci.bus_id,memory.total,memory.free&quot;)</span>

<span class="sd">    ---------------------------------------------------------------------------</span>
<span class="sd">    For a list of filtered dictionary elements by enumeration value.</span>
<span class="sd">    See help_query_gpu.txt or DeviceQuery(&quot;--help_query_gpu&quot;) for available filter elements</span>

<span class="sd">    $ DeviceQuery([NVSMI_PCI_BUS_ID, NVSMI_MEMORY_TOTAL, NVSMI_MEMORY_FREE])</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">filter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="nb">filter</span> <span class="o">=</span> <span class="p">[</span><span class="n">NVSMI_ALL</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">filter</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">filter</span> <span class="o">==</span> <span class="s2">&quot;--help&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">filter</span> <span class="o">==</span> <span class="s2">&quot;-h&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">DeviceQuery</span><span class="o">.</span><span class="vm">__doc__</span>
      <span class="k">elif</span> <span class="nb">filter</span> <span class="o">==</span> <span class="s2">&quot;--help-query-gpu&quot;</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;help_query_gpu.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fin</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">fin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="nb">filter</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__fromDeviceQueryString</span><span class="p">(</span><span class="nb">filter</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="nb">filter</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">)</span>

    <span class="n">nvidia_smi_results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">dictResult</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_TIMESTAMP</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
        <span class="n">nvidia_smi_results</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
            <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
            <span class="p">)</span>
      <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_DRIVER_VERSION</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
        <span class="n">nvidia_smi_results</span><span class="p">[</span><span class="s2">&quot;driver_version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
            <span class="n">nvmlSystemGetDriverVersion</span><span class="p">()</span>
            <span class="p">)</span>

      <span class="n">deviceCount</span> <span class="o">=</span> <span class="n">nvmlDeviceGetCount</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_COUNT</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
        <span class="n">nvidia_smi_results</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">deviceCount</span>

      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">deviceCount</span><span class="p">):</span>
        <span class="n">gpuResults</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__handles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="n">pciInfo</span> <span class="o">=</span> <span class="n">nvmlDeviceGetPciInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_BUS_ID</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">pciInfo</span><span class="o">.</span><span class="n">busId</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_NAME</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;product_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
              <span class="n">nvmlDeviceGetName</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
              <span class="p">)</span>

          <span class="k">try</span><span class="p">:</span>
            <span class="c1"># if nvmlDeviceGetBrand() succeeds it is guaranteed to be in the dictionary</span>
            <span class="n">brandName</span> <span class="o">=</span> <span class="n">NVSMI_BRAND_NAMES</span><span class="p">[</span><span class="n">nvmlDeviceGetBrand</span><span class="p">(</span><span class="n">handle</span><span class="p">)]</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">brandName</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;product_brand&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">brandName</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_DISPLAY_MODE</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;Enabled&quot;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">nvmlDeviceGetDisplayMode</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">else</span> <span class="s2">&quot;Disabled&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;display_mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_DISPLAY_ACTIVE</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;Enabled&quot;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">nvmlDeviceGetDisplayActive</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">else</span> <span class="s2">&quot;Disabled&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;display_active&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PERSISTENCE_MODE</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;Enabled&quot;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">nvmlDeviceGetPersistenceMode</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">else</span> <span class="s2">&quot;Disabled&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;persistence_mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mode</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_ACCT_MODE</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;Enabled&quot;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">nvmlDeviceGetAccountingMode</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">else</span> <span class="s2">&quot;Disabled&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;accounting_mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mode</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_ACCT_BUFFER_SIZE</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">bufferSize</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                <span class="n">nvmlDeviceGetAccountingBufferSize</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">bufferSize</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;accounting_mode_buffer_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bufferSize</span>

        <span class="n">driverModel</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">includeDriverModel</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_DRIVER_MODEL_CUR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">current</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;WDDM&quot;</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">nvmlDeviceGetCurrentDriverModel</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
                    <span class="o">==</span> <span class="n">NVML_DRIVER_WDDM</span>
                <span class="p">)</span>
                <span class="k">else</span> <span class="s2">&quot;TCC&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">driverModel</span><span class="p">[</span><span class="s2">&quot;current_dm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current</span>
          <span class="n">includeDriverModel</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_DRIVER_MODEL_PENDING</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">pending</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;WDDM&quot;</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">nvmlDeviceGetPendingDriverModel</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
                    <span class="o">==</span> <span class="n">NVML_DRIVER_WDDM</span>
                <span class="p">)</span>
                <span class="k">else</span> <span class="s2">&quot;TCC&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">pending</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">driverModel</span><span class="p">[</span><span class="s2">&quot;pending_dm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pending</span>
          <span class="n">includeDriverModel</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeDriverModel</span><span class="p">:</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;driver_model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">driverModel</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_SERIALNUMBER</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">serial</span> <span class="o">=</span> <span class="n">nvmlDeviceGetSerial</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">serial</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;serial&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">serial</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_UUID</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">uuid</span> <span class="o">=</span> <span class="n">nvmlDeviceGetUUID</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">uuid</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;uuid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">uuid</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_INDEX</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">minor_number</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMinorNumber</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">minor_number</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;minor_number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">minor_number</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_VBIOS_VER</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">vbios</span> <span class="o">=</span> <span class="n">nvmlDeviceGetVbiosVersion</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">vbios</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;vbios_version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">vbios</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_VBIOS_VER</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">multiGpuBool</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMultiGpuBoard</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">multiGpuBool</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="k">if</span> <span class="n">multiGpuBool</span> <span class="o">==</span> <span class="s2">&quot;N/A&quot;</span><span class="p">:</span>
            <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;multigpu_board&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
          <span class="k">elif</span> <span class="n">multiGpuBool</span><span class="p">:</span>
            <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;multigpu_board&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Yes&quot;</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;multigpu_board&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;No&quot;</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_BOARD_ID</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">boardId</span> <span class="o">=</span> <span class="n">nvmlDeviceGetBoardId</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">boardId</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="k">try</span><span class="p">:</span>
            <span class="n">hexBID</span> <span class="o">=</span> <span class="s2">&quot;0x</span><span class="si">%x</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">boardId</span>
          <span class="k">except</span><span class="p">:</span>
            <span class="n">hexBID</span> <span class="o">=</span> <span class="n">boardId</span>

          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;board_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hexBID</span>

        <span class="n">inforomVersion</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">includeInforom</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_INFOROM_IMG</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">nvmlDeviceGetInforomImageVersion</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">inforomVersion</span><span class="p">[</span><span class="s2">&quot;img_version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
          <span class="n">includeInforom</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_INFOROM_OEM</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">oem</span> <span class="o">=</span> <span class="n">nvmlDeviceGetInforomVersion</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_INFOROM_OEM</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">oem</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">inforomVersion</span><span class="p">[</span><span class="s2">&quot;oem_object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">oem</span><span class="p">)</span>
          <span class="n">includeInforom</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_INFOROM_ECC</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">ecc</span> <span class="o">=</span> <span class="n">nvmlDeviceGetInforomVersion</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_INFOROM_ECC</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">ecc</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">inforomVersion</span><span class="p">[</span><span class="s2">&quot;ecc_object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">ecc</span><span class="p">)</span>
          <span class="n">includeInforom</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_INFOROM_PWR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">pwr</span> <span class="o">=</span> <span class="n">nvmlDeviceGetInforomVersion</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_INFOROM_POWER</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">pwr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">inforomVersion</span><span class="p">[</span><span class="s2">&quot;pwr_object&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">pwr</span><span class="p">)</span>
          <span class="n">includeInforom</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeInforom</span><span class="p">:</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;inforom_version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inforomVersion</span>

        <span class="n">gpuOperationMode</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">includeGOM</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_INFOROM_PWR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toStrGOM</span><span class="p">(</span>
                <span class="n">nvmlDeviceGetCurrentGpuOperationMode</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">gpuOperationMode</span><span class="p">[</span><span class="s2">&quot;current_gom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>
          <span class="n">includeGOM</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_INFOROM_PWR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">pending</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toStrGOM</span><span class="p">(</span>
                <span class="n">nvmlDeviceGetPendingGpuOperationMode</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">pending</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuOperationMode</span><span class="p">[</span><span class="s2">&quot;pending_gom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">pending</span><span class="p">)</span>
          <span class="n">includeGOM</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeGOM</span><span class="p">:</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;gpu_operation_mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gpuOperationMode</span>

        <span class="n">pci</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">includePci</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_BUS</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">pci</span><span class="p">[</span><span class="s2">&quot;pci_bus&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%02X</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pciInfo</span><span class="o">.</span><span class="n">bus</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_DEVICE</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">pci</span><span class="p">[</span><span class="s2">&quot;pci_device&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%02X</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pciInfo</span><span class="o">.</span><span class="n">device</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_DOMAIN</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">pci</span><span class="p">[</span><span class="s2">&quot;pci_domain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%04X</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pciInfo</span><span class="o">.</span><span class="n">domain</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_DEVICE_ID</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">pci</span><span class="p">[</span><span class="s2">&quot;pci_device_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%08X</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pciInfo</span><span class="o">.</span><span class="n">pciDeviceId</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_BUS_ID</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">pci</span><span class="p">[</span><span class="s2">&quot;pci_bus_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">pciInfo</span><span class="o">.</span><span class="n">busId</span><span class="p">)</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_SUBDEVICE_ID</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">pci</span><span class="p">[</span><span class="s2">&quot;pci_sub_system_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%08X</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pciInfo</span><span class="o">.</span><span class="n">pciSubSystemId</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">pciGpuLinkInfo</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">includeLinkInfo</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">pciGen</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">includeGen</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_LINK_GEN_MAX</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">gen</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                <span class="n">nvmlDeviceGetMaxPcieLinkGeneration</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">gen</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">pciGen</span><span class="p">[</span><span class="s2">&quot;max_link_gen&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gen</span>
          <span class="n">includeGen</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_LINK_GEN_CUR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">gen</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                <span class="n">nvmlDeviceGetCurrPcieLinkGeneration</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">gen</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">pciGen</span><span class="p">[</span><span class="s2">&quot;current_link_gen&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gen</span>
          <span class="n">includeGen</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeGen</span><span class="p">:</span>
          <span class="n">pciGpuLinkInfo</span><span class="p">[</span><span class="s2">&quot;pcie_gen&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pciGen</span>
          <span class="n">includeLinkInfo</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">pciLinkWidths</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">includeLinkWidths</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_LINK_WIDTH_MAX</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">nvmlDeviceGetMaxPcieLinkWidth</span><span class="p">(</span><span class="n">handle</span><span class="p">))</span>
                <span class="o">+</span> <span class="s2">&quot;x&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">pciLinkWidths</span><span class="p">[</span><span class="s2">&quot;max_link_width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">width</span>
          <span class="n">includeLinkWidths</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PCI_LINK_WIDTH_CUR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">nvmlDeviceGetCurrPcieLinkWidth</span><span class="p">(</span><span class="n">handle</span><span class="p">))</span>
                <span class="o">+</span> <span class="s2">&quot;x&quot;</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">pciLinkWidths</span><span class="p">[</span><span class="s2">&quot;current_link_width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">width</span>
          <span class="n">includeLinkWidths</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeLinkWidths</span><span class="p">:</span>
          <span class="n">pciGpuLinkInfo</span><span class="p">[</span><span class="s2">&quot;link_widths&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pciLinkWidths</span>
          <span class="n">includeLinkInfo</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeLinkInfo</span><span class="p">:</span>
          <span class="n">pci</span><span class="p">[</span><span class="s2">&quot;pci_gpu_link_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pciGpuLinkInfo</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">pciBridgeChip</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">includeBridgeChip</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">bridgeHierarchy</span> <span class="o">=</span> <span class="n">nvmlDeviceGetBridgeChipInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">bridge_type</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">bridgeHierarchy</span><span class="o">.</span><span class="n">bridgeChipInfo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
              <span class="n">bridge_type</span> <span class="o">+=</span> <span class="s2">&quot;PLX&quot;</span>
            <span class="k">else</span><span class="p">:</span>
              <span class="n">bridge_type</span> <span class="o">+=</span> <span class="s2">&quot;BR04&quot;</span>
            <span class="n">pciBridgeChip</span><span class="p">[</span><span class="s2">&quot;bridge_chip_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bridge_type</span>

            <span class="k">if</span> <span class="n">bridgeHierarchy</span><span class="o">.</span><span class="n">bridgeChipInfo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fwVersion</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
              <span class="n">strFwVersion</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
            <span class="k">else</span><span class="p">:</span>
              <span class="n">strFwVersion</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%08X</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                  <span class="n">bridgeHierarchy</span><span class="o">.</span><span class="n">bridgeChipInfo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fwVersion</span>
              <span class="p">)</span>
            <span class="n">pciBridgeChip</span><span class="p">[</span><span class="s2">&quot;bridge_chip_fw&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                <span class="n">strFwVersion</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">pciBridgeChip</span><span class="p">[</span><span class="s2">&quot;bridge_chip_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">pciBridgeChip</span><span class="p">[</span><span class="s2">&quot;bridge_chip_fw&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">includeBridgeChip</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeBridgeChip</span><span class="p">:</span>
          <span class="n">pci</span><span class="p">[</span><span class="s2">&quot;pci_bridge_chip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pciBridgeChip</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">replay</span> <span class="o">=</span> <span class="n">nvmlDeviceGetPcieReplayCounter</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">pci</span><span class="p">[</span><span class="s2">&quot;replay_counter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span><span class="n">replay</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">pci</span><span class="p">[</span><span class="s2">&quot;replay_counter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">tx_bytes</span> <span class="o">=</span> <span class="n">nvmlDeviceGetPcieThroughput</span><span class="p">(</span>
                <span class="n">handle</span><span class="p">,</span> <span class="n">NVML_PCIE_UTIL_TX_BYTES</span>
                <span class="p">)</span>
            <span class="n">pci</span><span class="p">[</span><span class="s2">&quot;tx_util&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tx_bytes</span>
            <span class="n">pci</span><span class="p">[</span><span class="s2">&quot;tx_util_unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;KB/s&quot;</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">pci</span><span class="p">[</span><span class="s2">&quot;tx_util&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">rx_bytes</span> <span class="o">=</span> <span class="n">nvmlDeviceGetPcieThroughput</span><span class="p">(</span>
                <span class="n">handle</span><span class="p">,</span> <span class="n">NVML_PCIE_UTIL_RX_BYTES</span>
                <span class="p">)</span>
            <span class="n">pci</span><span class="p">[</span><span class="s2">&quot;rx_util&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rx_bytes</span>
            <span class="n">pci</span><span class="p">[</span><span class="s2">&quot;rx_util_unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;KB/s&quot;</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">pci</span><span class="p">[</span><span class="s2">&quot;rx_util&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">includePci</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includePci</span><span class="p">:</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;pci&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pci</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_FAN_SPEED</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">fan</span> <span class="o">=</span> <span class="n">nvmlDeviceGetFanSpeed</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">fan</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;fan_speed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fan</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;fan_speed_unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;%&quot;</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_PSTATE</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">perfState</span> <span class="o">=</span> <span class="n">nvmlDeviceGetPowerState</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">perfStateStr</span> <span class="o">=</span> <span class="s2">&quot;P</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">perfState</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">perfStateStr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;performance_state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">perfStateStr</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_SUPPORTED</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_ACTIVE</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_IDLE</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_APP_SETTING</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_SW_PWR_CAP</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_HW_SLOWDOWN</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_HW_THERMAL_SLOWDOWN</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_HW_PWR_BRAKE_SLOWDOWN</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_SW_THERMAL_SLOWDOWN</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_CLOCK_THROTTLE_REASONS_SYNC_BOOST</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="p">):</span>
          <span class="n">gpuResults</span><span class="p">[</span>
            <span class="s2">&quot;clocks_throttle&quot;</span>
          <span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__GetClocksThrottleReasons</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>

        <span class="n">fbMemoryUsage</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">includeMemoryUsage</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_MEMORY_TOTAL</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_MEMORY_USED</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_MEMORY_FREE</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="p">):</span>

          <span class="n">includeMemoryUsage</span> <span class="o">=</span> <span class="kc">True</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">memInfo</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMemoryInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">mem_total</span> <span class="o">=</span> <span class="n">memInfo</span><span class="o">.</span><span class="n">total</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
            <span class="n">mem_used</span> <span class="o">=</span> <span class="n">memInfo</span><span class="o">.</span><span class="n">used</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
            <span class="n">mem_free</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">memInfo</span><span class="o">.</span><span class="n">total</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">-</span> <span class="n">memInfo</span><span class="o">.</span><span class="n">used</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">mem_total</span> <span class="o">=</span> <span class="n">error</span>
            <span class="n">mem_used</span> <span class="o">=</span> <span class="n">error</span>
            <span class="n">mem_free</span> <span class="o">=</span> <span class="n">error</span>

          <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_MEMORY_TOTAL</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
            <span class="n">fbMemoryUsage</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mem_total</span>

          <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_MEMORY_USED</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
            <span class="n">fbMemoryUsage</span><span class="p">[</span><span class="s2">&quot;used&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mem_used</span>

          <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_MEMORY_FREE</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
            <span class="n">fbMemoryUsage</span><span class="p">[</span><span class="s2">&quot;free&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mem_free</span>

        <span class="k">if</span> <span class="n">includeMemoryUsage</span><span class="p">:</span>
          <span class="n">fbMemoryUsage</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MiB&quot;</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;fb_memory_usage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fbMemoryUsage</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_MEMORY_BAR1</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">memInfo</span> <span class="o">=</span> <span class="n">nvmlDeviceGetBAR1MemoryInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">mem_total</span> <span class="o">=</span> <span class="n">memInfo</span><span class="o">.</span><span class="n">bar1Total</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
            <span class="n">mem_used</span> <span class="o">=</span> <span class="n">memInfo</span><span class="o">.</span><span class="n">bar1Used</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
            <span class="n">mem_free</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">memInfo</span><span class="o">.</span><span class="n">bar1Total</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
                <span class="o">-</span> <span class="n">memInfo</span><span class="o">.</span><span class="n">bar1Used</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
            <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">mem_total</span> <span class="o">=</span> <span class="n">error</span>
            <span class="n">mem_used</span> <span class="o">=</span> <span class="n">error</span>
            <span class="n">mem_free</span> <span class="o">=</span> <span class="n">error</span>

          <span class="n">bar1MemoryUsage</span> <span class="o">=</span> <span class="p">{}</span>
          <span class="n">bar1MemoryUsage</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mem_total</span>
          <span class="n">bar1MemoryUsage</span><span class="p">[</span><span class="s2">&quot;used&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mem_used</span>
          <span class="n">bar1MemoryUsage</span><span class="p">[</span><span class="s2">&quot;free&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mem_free</span>
          <span class="n">bar1MemoryUsage</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MiB&quot;</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;bar1_memory_usage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bar1MemoryUsage</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_COMPUTE_MODE</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="n">nvmlDeviceGetComputeMode</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">NVML_COMPUTEMODE_DEFAULT</span><span class="p">:</span>
              <span class="n">modeStr</span> <span class="o">=</span> <span class="s2">&quot;Default&quot;</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">NVML_COMPUTEMODE_EXCLUSIVE_THREAD</span><span class="p">:</span>
              <span class="n">modeStr</span> <span class="o">=</span> <span class="s2">&quot;Exclusive Thread&quot;</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">NVML_COMPUTEMODE_PROHIBITED</span><span class="p">:</span>
              <span class="n">modeStr</span> <span class="o">=</span> <span class="s2">&quot;Prohibited&quot;</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">NVML_COMPUTEMODE_EXCLUSIVE_PROCESS</span><span class="p">:</span>
              <span class="n">modeStr</span> <span class="o">=</span> <span class="s2">&quot;Exclusive_Process&quot;</span>
            <span class="k">else</span><span class="p">:</span>
              <span class="n">modeStr</span> <span class="o">=</span> <span class="s2">&quot;Unknown&quot;</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">modeStr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;compute_mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">modeStr</span>

        <span class="n">utilization</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">includeUtilization</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_UTILIZATION_GPU</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_UTILIZATION_MEM</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="p">):</span>

          <span class="k">try</span><span class="p">:</span>
            <span class="n">util</span> <span class="o">=</span> <span class="n">nvmlDeviceGetUtilizationRates</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">gpu_util</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">gpu</span>
            <span class="n">mem_util</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">memory</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">gpu_util</span> <span class="o">=</span> <span class="n">error</span>
            <span class="n">mem_util</span> <span class="o">=</span> <span class="n">error</span>

          <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_UTILIZATION_GPU</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
            <span class="n">utilization</span><span class="p">[</span><span class="s2">&quot;gpu_util&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gpu_util</span>

          <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_UTILIZATION_MEM</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
            <span class="n">utilization</span><span class="p">[</span><span class="s2">&quot;memory_util&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mem_util</span>

          <span class="n">includeUtilization</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_UTILIZATION_ENCODER</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="p">(</span><span class="n">util_int</span><span class="p">,</span> <span class="n">ssize</span><span class="p">)</span> <span class="o">=</span> <span class="n">nvmlDeviceGetEncoderUtilization</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">encoder_util</span> <span class="o">=</span> <span class="n">util_int</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">encoder_util</span> <span class="o">=</span> <span class="n">error</span>

          <span class="n">utilization</span><span class="p">[</span><span class="s2">&quot;encoder_util&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">encoder_util</span>
          <span class="n">includeUtilization</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_UTILIZATION_DECODER</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="p">(</span><span class="n">util_int</span><span class="p">,</span> <span class="n">ssize</span><span class="p">)</span> <span class="o">=</span> <span class="n">nvmlDeviceGetDecoderUtilization</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">decoder_util</span> <span class="o">=</span> <span class="n">util_int</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">decoder_util</span> <span class="o">=</span> <span class="n">error</span>

          <span class="n">utilization</span><span class="p">[</span><span class="s2">&quot;decoder_util&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">decoder_util</span>
          <span class="n">includeUtilization</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeUtilization</span><span class="p">:</span>
          <span class="n">utilization</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;%&quot;</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;utilization&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">utilization</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_ECC_MODE_CUR</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_ECC_MODE_PENDING</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="p">):</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">pending</span><span class="p">)</span> <span class="o">=</span> <span class="n">nvmlDeviceGetEccMode</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">curr_str</span> <span class="o">=</span> <span class="s2">&quot;Enabled&quot;</span> <span class="k">if</span> <span class="p">(</span><span class="n">current</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;Disabled&quot;</span>
            <span class="n">pend_str</span> <span class="o">=</span> <span class="s2">&quot;Enabled&quot;</span> <span class="k">if</span> <span class="p">(</span><span class="n">pending</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;Disabled&quot;</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">curr_str</span> <span class="o">=</span> <span class="n">error</span>
            <span class="n">pend_str</span> <span class="o">=</span> <span class="n">error</span>

          <span class="n">eccMode</span> <span class="o">=</span> <span class="p">{}</span>
          <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_ECC_MODE_CUR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
            <span class="n">eccMode</span><span class="p">[</span><span class="s2">&quot;current_ecc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">curr_str</span>

          <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_ECC_MODE_PENDING</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
            <span class="n">eccMode</span><span class="p">[</span><span class="s2">&quot;pending_ecc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pend_str</span>

          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;ecc_mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eccMode</span>

        <span class="n">eccErrors</span><span class="p">,</span> <span class="n">includeEccErrors</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__GetEcc</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">filter</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">includeEccErrors</span><span class="p">:</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;ecc_errors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eccErrors</span>

        <span class="n">retiredPages</span><span class="p">,</span> <span class="n">includeRetiredPages</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__GetRetiredPages</span><span class="p">(</span>
            <span class="n">handle</span><span class="p">,</span> <span class="nb">filter</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">includeRetiredPages</span><span class="p">:</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;retired_pages&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">retiredPages</span>

        <span class="n">temperature</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">includeTemperature</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_TEMPERATURE_GPU</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">nvmlDeviceGetTemperature</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_TEMPERATURE_GPU</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">temperature</span><span class="p">[</span><span class="s2">&quot;gpu_temp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>
          <span class="n">includeTemperature</span> <span class="o">=</span> <span class="kc">True</span>

          <span class="k">try</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">nvmlDeviceGetTemperatureThreshold</span><span class="p">(</span>
                <span class="n">handle</span><span class="p">,</span> <span class="n">NVML_TEMPERATURE_THRESHOLD_SHUTDOWN</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">temperature</span><span class="p">[</span><span class="s2">&quot;gpu_temp_max_threshold&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>
          <span class="n">includeTemperature</span> <span class="o">=</span> <span class="kc">True</span>

          <span class="k">try</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">nvmlDeviceGetTemperatureThreshold</span><span class="p">(</span>
                <span class="n">handle</span><span class="p">,</span> <span class="n">NVML_TEMPERATURE_THRESHOLD_SLOWDOWN</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">temperature</span><span class="p">[</span><span class="s2">&quot;gpu_temp_slow_threshold&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>
          <span class="n">includeTemperature</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeTemperature</span><span class="p">:</span>
          <span class="n">temperature</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temperature</span>

        <span class="n">power_readings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">includePowerReadings</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_POWER_MGMT</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">powMan</span> <span class="o">=</span> <span class="n">nvmlDeviceGetPowerManagementMode</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">powManStr</span> <span class="o">=</span> <span class="s2">&quot;Supported&quot;</span> <span class="k">if</span> <span class="n">powMan</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;N/A&quot;</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">powManStr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">power_readings</span><span class="p">[</span><span class="s2">&quot;power_management&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">powManStr</span>
          <span class="n">includePowerReadings</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_POWER_DRAW</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">powDraw</span> <span class="o">=</span> <span class="n">nvmlDeviceGetPowerUsage</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span>
            <span class="n">powDrawStr</span> <span class="o">=</span> <span class="n">powDraw</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">powDrawStr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">power_readings</span><span class="p">[</span><span class="s2">&quot;power_draw&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">powDrawStr</span>
          <span class="n">includePowerReadings</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_POWER_LIMIT</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">powLimit</span> <span class="o">=</span> <span class="n">nvmlDeviceGetPowerManagementLimit</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span>
            <span class="n">powLimitStr</span> <span class="o">=</span> <span class="n">powLimit</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">powLimitStr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">power_readings</span><span class="p">[</span><span class="s2">&quot;power_limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">powLimitStr</span>
          <span class="n">includePowerReadings</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_POWER_LIMIT_DEFAULT</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">powLimit</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">nvmlDeviceGetPowerManagementDefaultLimit</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span>
            <span class="p">)</span>
            <span class="n">powLimitStr</span> <span class="o">=</span> <span class="n">powLimit</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">powLimitStr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">power_readings</span><span class="p">[</span><span class="s2">&quot;default_power_limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">powLimitStr</span>
          <span class="n">includePowerReadings</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_POWER_LIMIT_ENFORCED</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">enforcedPowLimit</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">nvmlDeviceGetEnforcedPowerLimit</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span>
            <span class="p">)</span>
            <span class="n">enforcedPowLimitStr</span> <span class="o">=</span> <span class="n">enforcedPowLimit</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">enforcedPowLimitStr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">power_readings</span><span class="p">[</span><span class="s2">&quot;enforced_power_limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enforcedPowLimitStr</span>
          <span class="n">includePowerReadings</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_POWER_LIMIT_MIN</span> <span class="ow">in</span> <span class="nb">filter</span>
            <span class="ow">or</span> <span class="n">NVSMI_POWER_LIMIT_MAX</span> <span class="ow">in</span> <span class="nb">filter</span>
        <span class="p">):</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">powLimit</span> <span class="o">=</span> <span class="n">nvmlDeviceGetPowerManagementLimitConstraints</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="n">powLimitStrMin</span> <span class="o">=</span> <span class="n">powLimit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1000.0</span>
            <span class="n">powLimitStrMax</span> <span class="o">=</span> <span class="n">powLimit</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1000.0</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">powLimitStrMin</span> <span class="o">=</span> <span class="n">error</span>
            <span class="n">powLimitStrMax</span> <span class="o">=</span> <span class="n">error</span>

          <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_POWER_LIMIT_MIN</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
            <span class="n">power_readings</span><span class="p">[</span><span class="s2">&quot;min_power_limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">powLimitStrMin</span>
          <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_POWER_LIMIT_MAX</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
            <span class="n">power_readings</span><span class="p">[</span><span class="s2">&quot;max_power_limit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">powLimitStrMax</span>
          <span class="n">includePowerReadings</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includePowerReadings</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">perfState</span> <span class="o">=</span> <span class="s2">&quot;P&quot;</span> <span class="o">+</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                <span class="n">nvmlDeviceGetPowerState</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">perfState</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">power_readings</span><span class="p">[</span><span class="s2">&quot;power_state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">perfState</span>

          <span class="n">power_readings</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;W&quot;</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;power_readings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">power_readings</span>

        <span class="n">clocks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">includeClocks</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_GRAPHICS_CUR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">graphics</span> <span class="o">=</span> <span class="n">nvmlDeviceGetClockInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_GRAPHICS</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">graphics</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">clocks</span><span class="p">[</span><span class="s2">&quot;graphics_clock&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graphics</span>
          <span class="n">includeClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_GRAPHICS_CUR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">sm</span> <span class="o">=</span> <span class="n">nvmlDeviceGetClockInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_SM</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">sm</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">clocks</span><span class="p">[</span><span class="s2">&quot;sm_clock&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sm</span>
          <span class="n">includeClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_MEMORY_CUR</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="n">nvmlDeviceGetClockInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_MEM</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">clocks</span><span class="p">[</span><span class="s2">&quot;mem_clock&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mem</span>
          <span class="n">includeClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeClocks</span><span class="p">:</span>
          <span class="n">clocks</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MHz&quot;</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;clocks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clocks</span>

        <span class="n">applicationClocks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">includeAppClocks</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_APPL_GRAPHICS</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">graphics</span> <span class="o">=</span> <span class="n">nvmlDeviceGetApplicationsClock</span><span class="p">(</span>
                <span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_GRAPHICS</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">graphics</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">applicationClocks</span><span class="p">[</span><span class="s2">&quot;graphics_clock&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graphics</span>
          <span class="n">includeAppClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_APPL_MEMORY</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="n">nvmlDeviceGetApplicationsClock</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_MEM</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">applicationClocks</span><span class="p">[</span><span class="s2">&quot;mem_clock&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mem</span>
          <span class="n">includeAppClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeAppClocks</span><span class="p">:</span>
          <span class="n">applicationClocks</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MHz&quot;</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;applications_clocks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">applicationClocks</span>

        <span class="n">defaultApplicationClocks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">includeDefaultAppClocks</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_APPL_GRAPHICS_DEFAULT</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">graphics</span> <span class="o">=</span> <span class="n">nvmlDeviceGetDefaultApplicationsClock</span><span class="p">(</span>
                <span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_GRAPHICS</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">graphics</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">defaultApplicationClocks</span><span class="p">[</span><span class="s2">&quot;graphics_clock&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graphics</span>
          <span class="n">includeDefaultAppClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_APPL_MEMORY_DEFAULT</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="n">nvmlDeviceGetDefaultApplicationsClock</span><span class="p">(</span>
                <span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_MEM</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">defaultApplicationClocks</span><span class="p">[</span><span class="s2">&quot;mem_clock&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mem</span>
          <span class="n">includeDefaultAppClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeDefaultAppClocks</span><span class="p">:</span>
          <span class="n">defaultApplicationClocks</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MHz&quot;</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;default_applications_clocks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultApplicationClocks</span>

        <span class="n">maxClocks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">includeMaxClocks</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_GRAPHICS_MAX</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">graphics</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMaxClockInfo</span><span class="p">(</span>
                <span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_GRAPHICS</span>
                <span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">graphics</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">maxClocks</span><span class="p">[</span><span class="s2">&quot;graphics_clock&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">graphics</span>
          <span class="n">includeMaxClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_SM_MAX</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">sm</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMaxClockInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_SM</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">sm</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">maxClocks</span><span class="p">[</span><span class="s2">&quot;sm_clock&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sm</span>
          <span class="n">includeMaxClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_MEMORY_MAX</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="n">nvmlDeviceGetMaxClockInfo</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">NVML_CLOCK_MEM</span><span class="p">)</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">mem</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
          <span class="n">maxClocks</span><span class="p">[</span><span class="s2">&quot;mem_clock&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mem</span>
          <span class="n">includeMaxClocks</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">includeMaxClocks</span><span class="p">:</span>
          <span class="n">maxClocks</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MHz&quot;</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;max_clocks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">maxClocks</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_POLICY</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">clockPolicy</span> <span class="o">=</span> <span class="p">{}</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="p">(</span>
                <span class="n">boostedState</span><span class="p">,</span>
                <span class="n">boostedDefaultState</span><span class="p">,</span>
                <span class="p">)</span> <span class="o">=</span> <span class="n">nvmlDeviceGetAutoBoostedClocksEnabled</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">boostedState</span> <span class="o">==</span> <span class="n">NVML_FEATURE_DISABLED</span><span class="p">:</span>
              <span class="n">autoBoostStr</span> <span class="o">=</span> <span class="s2">&quot;Off&quot;</span>
            <span class="k">else</span><span class="p">:</span>
              <span class="n">autoBoostStr</span> <span class="o">=</span> <span class="s2">&quot;On&quot;</span>

            <span class="k">if</span> <span class="n">boostedDefaultState</span> <span class="o">==</span> <span class="n">NVML_FEATURE_DISABLED</span><span class="p">:</span>
              <span class="n">autoBoostDefaultStr</span> <span class="o">=</span> <span class="s2">&quot;Off&quot;</span>
            <span class="k">else</span><span class="p">:</span>
              <span class="n">autoBoostDefaultStr</span> <span class="o">=</span> <span class="s2">&quot;On&quot;</span>

          <span class="k">except</span> <span class="n">NVMLError_NotSupported</span><span class="p">:</span>
            <span class="n">autoBoostStr</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
            <span class="n">autoBoostDefaultStr</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">autoBoostStr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="n">autoBoostDefaultStr</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">clockPolicy</span><span class="p">[</span><span class="s2">&quot;auto_boost&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">autoBoostStr</span>
          <span class="n">clockPolicy</span><span class="p">[</span><span class="s2">&quot;auto_boost_default&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">autoBoostDefaultStr</span>
          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;clock_policy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clockPolicy</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_CLOCKS_SUPPORTED</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">supportedClocks</span> <span class="o">=</span> <span class="p">[]</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">memClocks</span> <span class="o">=</span> <span class="n">nvmlDeviceGetSupportedMemoryClocks</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
            <span class="c1">#                     jj = 1</span>
            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">memClocks</span><span class="p">:</span>
              <span class="n">supportMemClock</span> <span class="o">=</span> <span class="p">{}</span>
              <span class="n">supportMemClock</span><span class="p">[</span><span class="s2">&quot;current&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span>
              <span class="n">supportMemClock</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MHz&quot;</span>

              <span class="n">supportedGraphicsClocks</span> <span class="o">=</span> <span class="p">[]</span>
              <span class="k">try</span><span class="p">:</span>
                <span class="n">clocks</span> <span class="o">=</span> <span class="n">nvmlDeviceGetSupportedGraphicsClocks</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">clocks</span><span class="p">:</span>
                  <span class="n">supportedGraphicsClocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
              <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="n">supportedGraphicsClocks</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

              <span class="n">supportMemClock</span><span class="p">[</span>
                <span class="s2">&quot;supported_graphics_clock&quot;</span>
              <span class="p">]</span> <span class="o">=</span> <span class="n">supportedGraphicsClocks</span>

              <span class="n">supportedClocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">supportMemClock</span><span class="p">)</span>
          <span class="c1">#                         jj+=1</span>

          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">supportedClocks</span><span class="p">[</span><span class="s2">&quot;Error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;supported_clocks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
              <span class="n">supportedClocks</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">supportedClocks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
          <span class="p">)</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_COMPUTE_APPS</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="n">processes</span> <span class="o">=</span> <span class="p">[]</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">procs</span> <span class="o">=</span> <span class="n">nvmlDeviceGetComputeRunningProcesses</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>

            <span class="c1">#                     ii = 1</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">procs</span><span class="p">:</span>
              <span class="k">try</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__toString</span><span class="p">(</span>
                    <span class="n">nvmlSystemGetProcessName</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">pid</span><span class="p">)</span>
                    <span class="p">)</span>
              <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">NVML_ERROR_NOT_FOUND</span><span class="p">:</span>
                  <span class="c1"># probably went away</span>
                  <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                  <span class="n">name</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
              <span class="n">processInfo</span> <span class="o">=</span> <span class="p">{}</span>
              <span class="n">processInfo</span><span class="p">[</span><span class="s2">&quot;pid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">pid</span>
              <span class="n">processInfo</span><span class="p">[</span><span class="s2">&quot;process_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>

              <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">usedGpuMemory</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">mem</span> <span class="o">=</span> <span class="mi">0</span>
              <span class="k">else</span><span class="p">:</span>
                <span class="n">mem</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">usedGpuMemory</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">)</span>
              <span class="n">processInfo</span><span class="p">[</span><span class="s2">&quot;used_memory&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mem</span>
              <span class="n">processInfo</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MiB&quot;</span>
              <span class="n">processes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">processInfo</span><span class="p">)</span>
          <span class="c1">#                          ii+=1</span>

          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">processes</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

          <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;processes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">processes</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">processes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">NVSMI_ALL</span> <span class="ow">in</span> <span class="nb">filter</span> <span class="ow">or</span> <span class="n">NVSMI_ACCOUNTED_APPS</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
            <span class="n">pids</span> <span class="o">=</span> <span class="n">nvmlDeviceGetAccountingPids</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>

            <span class="n">accountProcess</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1">#                      ii = 1</span>
            <span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">pids</span><span class="p">:</span>
              <span class="k">try</span><span class="p">:</span>
                <span class="n">stats</span> <span class="o">=</span> <span class="n">nvmlDeviceGetAccountingStats</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>
                <span class="n">gpuUtilization</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> </span><span class="si">%%</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stats</span><span class="o">.</span><span class="n">gpuUtilization</span>
                <span class="n">memoryUtilization</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> </span><span class="si">%%</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stats</span><span class="o">.</span><span class="n">memoryUtilization</span>
                <span class="k">if</span> <span class="n">stats</span><span class="o">.</span><span class="n">maxMemoryUsage</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                  <span class="n">maxMemoryUsage</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                  <span class="n">maxMemoryUsage</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> MiB&quot;</span> <span class="o">%</span> <span class="p">(</span>
                      <span class="n">stats</span><span class="o">.</span><span class="n">maxMemoryUsage</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
                  <span class="p">)</span>
                <span class="n">time</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> ms&quot;</span> <span class="o">%</span> <span class="n">stats</span><span class="o">.</span><span class="n">time</span>
                <span class="n">is_running</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stats</span><span class="o">.</span><span class="n">isRunning</span>
              <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">NVML_ERROR_NOT_FOUND</span><span class="p">:</span>
                  <span class="c1"># probably went away</span>
                  <span class="k">continue</span>
                <span class="n">err</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
                <span class="n">gpuUtilization</span> <span class="o">=</span> <span class="n">err</span>
                <span class="n">memoryUtilization</span> <span class="o">=</span> <span class="n">err</span>
                <span class="n">maxMemoryUsage</span> <span class="o">=</span> <span class="n">err</span>
                <span class="n">time</span> <span class="o">=</span> <span class="n">err</span>
                <span class="n">is_running</span> <span class="o">=</span> <span class="n">err</span>

              <span class="n">accountProcessInfo</span> <span class="o">=</span> <span class="p">{}</span>
              <span class="n">accountProcessInfo</span><span class="p">[</span><span class="s2">&quot;pid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pid</span>
              <span class="n">accountProcessInfo</span><span class="p">[</span><span class="s2">&quot;gpu_util&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gpuUtilization</span>
              <span class="n">accountProcessInfo</span><span class="p">[</span><span class="s2">&quot;memory_util&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">memoryUtilization</span>
              <span class="n">accountProcessInfo</span><span class="p">[</span><span class="s2">&quot;max_memory_usage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">maxMemoryUsage</span>
              <span class="n">accountProcessInfo</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span>
              <span class="n">accountProcessInfo</span><span class="p">[</span><span class="s2">&quot;is_running&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">is_running</span>

              <span class="n">accountProcess</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accountProcessInfo</span><span class="p">)</span>

            <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;accounted_processes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">accountProcess</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">accountProcess</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="p">)</span>
          <span class="c1">#                          ii+=1</span>
          <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">gpuResults</span><span class="p">[</span><span class="s2">&quot;accounted_processes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">__handleError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gpuResults</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">dictResult</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gpuResults</span><span class="p">)</span>

      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dictResult</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">nvidia_smi_results</span><span class="p">[</span><span class="s2">&quot;gpu&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dictResult</span>

    <span class="k">except</span> <span class="n">NVMLError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;nvidia_smi.py: &quot;</span> <span class="o">+</span> <span class="n">err</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">nvidia_smi_results</span></div>

  <span class="k">def</span> <span class="nf">__to_str_dictionary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">indent</span><span class="p">):</span>
    <span class="n">strResults</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">):</span>
          <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">strResults</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="n">strResults</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__to_str_dictionary</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="n">indent</span><span class="p">)</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="n">strResults</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">collections</span><span class="o">.</span><span class="n">Mapping</span><span class="p">)):</span>
          <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)):</span>
            <span class="n">strResults</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">: [</span><span class="si">%d</span><span class="s2"> of </span><span class="si">%d</span><span class="s2">]</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">indent</span><span class="p">,</span>
                <span class="n">key</span><span class="p">,</span>
                <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="n">strResults</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__to_str_dictionary</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="n">indent</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">strResults</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
      <span class="n">strResults</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[Error] &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">strResults</span>

  <span class="k">def</span> <span class="nf">__to_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
    <span class="n">strResults</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">indent</span> <span class="o">=</span> <span class="s2">&quot;  &quot;</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
      <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)):</span>
          <span class="n">strResults</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">: [</span><span class="si">%d</span><span class="s2"> of </span><span class="si">%d</span><span class="s2">]</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
              <span class="n">indent</span><span class="p">,</span>
              <span class="n">key</span><span class="p">,</span>
              <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
              <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">),</span>
              <span class="p">)</span>
          <span class="n">strResults</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__to_str_dictionary</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="n">indent</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">strResults</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">strResults</span>

<div class="viewcode-block" id="NvidiaSMI.format"><a class="viewcode-back" href="../../../../generated/heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.html#heimdallr.utilities.nvidia.smi_parsing.NvidiaSMI.format">[docs]</a>  <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;description&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">results</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__to_str</span><span class="p">(</span><span class="n">results</span><span class="p">)</span></div></div>


<span class="c1"># this is not exectued when module is imported</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

  <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;description&quot;&quot;&quot;</span>
    <span class="c1"># evaluate arguments</span>
    <span class="n">as_xml</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">query_gpu_args</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)):</span>
      <span class="n">v</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
      <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;xml&quot;</span><span class="p">:</span>
        <span class="n">as_xml</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">query_gpu_args</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="c1"># execute device query</span>
    <span class="n">nvsmi</span> <span class="o">=</span> <span class="n">NvidiaSMI</span><span class="o">.</span><span class="n">getInstance</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">as_xml</span><span class="p">:</span>
      <span class="n">results</span> <span class="o">=</span> <span class="n">nvsmi</span><span class="o">.</span><span class="n">XmlDeviceQuery</span><span class="p">(</span><span class="n">query_gpu_args</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">results</span> <span class="o">=</span> <span class="n">nvsmi</span><span class="o">.</span><span class="n">DeviceQuery</span><span class="p">(</span><span class="n">query_gpu_args</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">nvsmi</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>


  <span class="n">main</span><span class="p">()</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/horn.svg" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../../../../index.html">heimdallr</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../generated/heimdallr.html">heimdallr</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started.html">Getting Started</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../index.html">Module code</a><ul>
  <li><a href="../../../heimdallr.html">heimdallr</a><ul>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>